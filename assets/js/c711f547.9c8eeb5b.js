"use strict";(self.webpackChunk_8x8_developer_docs=self.webpackChunk_8x8_developer_docs||[]).push([[65923],{3252:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/cfd6d87-ChatGatewayChannel-4dc6ec530dd7d9846185ae80e52bd623.png"},13932:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/c093697-NewChannel1-264637f26268ffe1856dbcbfcb77f414.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var s=t(96540);const a={},o=s.createContext(a);function i(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(o.Provider,{value:n},e.children)}},37613:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/14c401f-Webhook111-550946e0bfd2331812693c6b6151f613.png"},66715:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/42bf824-Webhook3-c87d73930f49687fe8d9f3fa00a606eb.png"},98509:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"actions-events/docs/chat-workflow","title":"Workflow - Connecting 3rd party channel","description":"Prerequisites","source":"@site/docs/actions-events/docs/chat-workflow.md","sourceDirName":"actions-events/docs","slug":"/actions-events/docs/chat-workflow","permalink":"/actions-events/docs/chat-workflow","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebarActionsEventsDocs","previous":{"title":"API Key","permalink":"/actions-events/docs/api-key"},"next":{"title":"Webhooks","permalink":"/actions-events/docs/webhooks-2"}}');var a=t(74848),o=t(28453);const i={},r="Workflow - Connecting 3rd party channel",c={},h=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setup flow",id:"setup-flow",level:2},{value:"Note",id:"note",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"workflow---connecting-3rd-party-channel",children:"Workflow - Connecting 3rd party channel"})}),"\n",(0,a.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsx)(n.p,{children:"To use the Chat Gateway you must have the following:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"At least one configured queue so that any interactions coming from your customers can be routed to your agents."}),"\n",(0,a.jsx)(n.li,{children:"At least one agent is assigned to your queue, so they can pick up the queued interactions and connect with your customers."}),"\n",(0,a.jsx)(n.li,{children:"Know the Queue ID."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Information on how to do this can be found ",(0,a.jsx)(n.a,{href:"https://docs.8x8.com/8x8WebHelp/VCC/configuration-manager-vovcc/content/queuechatqueue.htm?Highlight=chat%20queue",children:"here"})]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"A client application that calls the Chat API and listens for messages (i.e., events) that are returned."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"setup-flow",children:"Setup flow"}),"\n",(0,a.jsx)(n.p,{children:"To set up the Chat Gateway do the following:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"API key"})," Follow the flow to get your access token ",(0,a.jsx)(n.a,{href:"/actions-events/docs/api-key",children:"API Key"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Next, we need to create the webhook, so that data can be sent between 8x8 and the application and also the channel, which allows the webhook to connect to 8x8. There are two flows, via the API and in configuration manager in 8x8 Contact Center"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Create webhook"})," - ",(0,a.jsx)(n.a,{href:"/actions-events/reference/createwebhook-1",children:"API method"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Go to Configuration Manager - Integration - webhook"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image",src:t(37613).A+"",width:"1279",height:"326"})}),"\n",(0,a.jsx)(n.p,{children:"Then select Add webhook and populate with the details"}),"\n",(0,a.jsx)(n.p,{children:"Name - this is the name you want to give the webhook"}),"\n",(0,a.jsx)(n.p,{children:"URL - this is the webhook of the application that you want to communicate with the Chat Gateway"}),"\n",(0,a.jsx)(n.p,{children:"Chat API Version - This needS to be Chat Gateway"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image",src:t(66715).A+"",width:"1745",height:"750"})}),"\n",(0,a.jsx)(n.p,{children:"Now you can create a channel"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Create a channel"})," - ",(0,a.jsx)(n.a,{href:"/actions-events/reference/createchatapichannel-1",children:"API method"})]}),"\n",(0,a.jsx)(n.p,{children:"Go to Configuration Manager - Channel - Chat API"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image",src:t(3252).A+"",width:"1396",height:"254"})}),"\n",(0,a.jsx)(n.p,{children:"Select new channel, then populate the details"}),"\n",(0,a.jsx)(n.p,{children:"Name - the name you want to give the channel"}),"\n",(0,a.jsx)(n.p,{children:"Description - the description you want to give the channel"}),"\n",(0,a.jsx)(n.p,{children:"Webhook - select the webhook you have created in the step above, or a different one if you need"}),"\n",(0,a.jsx)(n.p,{children:"Queue - This is a queue that the channel will route to, however this can be changed in the conversation flow if needed"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image",src:t(13932).A+"",width:"1052",height:"503"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Create conversation"})," ",(0,a.jsx)(n.a,{href:"/actions-events/reference/createcctransaction-1",children:"API"})]}),"\n",(0,a.jsx)(n.p,{children:"When creating the conversation, the channnel ID and the API key which have been created earlier in the flow are needed."}),"\n",(0,a.jsx)(n.p,{children:"Information that can be passed across when creating the conversation"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"User object"})}),"\n",(0,a.jsx)(n.p,{children:"These allows you to give information about the customer to the agent and also populate the 8x8 Native CRM, in this example below"}),"\n",(0,a.jsx)(n.p,{children:"Language - the language of the customer"}),"\n",(0,a.jsx)(n.p,{children:"Name - name of the customer"}),"\n",(0,a.jsx)(n.p,{children:"Email - email address of the customer (this can be used to screen pop the customer record in the native CRM or an External CRM)"}),"\n",(0,a.jsx)(n.p,{children:"Phone - phone number of the customer"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n     "user": {\n          "language": "en",\n          "name": "James Jones",\n          "email": "user@example.com",\n          "phone": "07917846011"\n     }\n}\n\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"User object - Additional properties"})}),"\n",(0,a.jsx)(n.p,{children:"This allows extra information to be passed across to the agent, specifically customer values that can be conveyed using the format :customValue anyKey: anyValue.It is essential to recognize that customer values being passed must include both a key and a corresponding value."}),"\n",(0,a.jsx)(n.p,{children:"In the example below, the bot is telling the agent that the customer is authenticated, they were asking about their balance and it's regarding their credit account"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "additionalProperties": [\n        {\n            "key": "Authenticated",\n            "value": "yes"\n        },\n        {\n            "key": "Intent",\n            "value": "balance"\n        },\n        {\n            "key": "AccountType",\n            "value": "credit"\n        }\n    ]\n}\n\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"User object - History"})}),"\n",(0,a.jsx)(n.p,{children:"This allows the content of the conversation that has happened between the bot and the agent to be passed across to the agent."}),"\n",(0,a.jsx)(n.p,{children:"In the example below, it shows the conversation between the agent and bot regarding a balance which will be presented to the agent"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n     "history": {\n          "messages": [\n               {\n                    "authorType": "user",\n                    "text": "I would like my balance please"\n               },\n               {\n                    "authorType": "bot",\n                    "text": "Sure, please let me your account number"\n               },\n               {\n                    "authorType": "user",\n                    "text": "My account number is 1234"\n               },\n               {\n                    "authorType": "bot",\n                    "text": "Your balance is \xa312.34"\n               }\n          ]\n     }\n}\n\n'})}),"\n",(0,a.jsx)(n.p,{children:"Example JSON of the user objects together"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'curl --request POST  \n     --url [https://api.8x8.com/chat-gateway/v1/conversations](https://api.8x8.com/chat-gateway/v1/conversations)  \n     --header \'accept: application/hal+json\'  \n     --header \'content-type: application/json\'  \n     --data \'  \n{\n    "user": {\n        "language": "en",\n        "name": "James Jones",\n        "email": "user@example.com",\n        "phone": "013453403332",\n        "additionalProperties": [\n            {\n                "key": "Authenticated",\n                "value": "yes"\n            },\n            {\n                "key": "Intent",\n                "value": "balance"\n            },\n            {\n                "key":" AccountType",\n                "value": "credit"\n            }\n        ]\n    },\n    "assignment": {\n        "type": "queue",\n        "id":" 123"\n    },\n    "history": {\n        "messages": [\n            {\n                "authorType": "user",\n                "text": "Hello, can I get my balance please"\n            },\n            {\n                "authorType": "bot",\n                "text": "Sure, what is your account number"\n            },\n            {\n                "authorType": "user",\n                "text": "123456"\n            },\n            {\n                "authorType": "bot",\n                "text": "Your balance is \xa312.34"\n            },\n            {\n                "authorType": "user",\n                "text": "Thanks, please can I speak to an agent "\n            },\n            {\n                "authorType": "bot",\n                "text": "Sure, connecting you now"\n            }\n        ]\n    },\n    "channelId": "f5odm43occnifcdcsa"\n}\n\n'})}),"\n",(0,a.jsx)(n.p,{children:"In the history in the user objects, you can also add"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"User object - History - attachments"})}),"\n",(0,a.jsx)(n.p,{children:"When adding the user history, attachments that have been sent between the bot and the customer can also be added to this conversation"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"User object - History - adaptive cards"})}),"\n",(0,a.jsxs)(n.p,{children:["When adding the user history, adaptive cards that have been sent between the bot and customer can be added to the conversation. More information on adaptive cards can be found here - ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/adaptive-cards/",children:"MS Adaptive cards"})]}),"\n",(0,a.jsxs)(n.p,{children:["Once the conversation is created an activity will be sent for # ",(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"QUEUED"})})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "eventType": "QUEUED",\n  "conversationId": "ID-0",\n  "timestamp": 0,\n  "data": {\n    "queueId": "string",\n    "queueName": "string"\n  }\n}\n\n'})}),"\n",(0,a.jsx)(n.p,{children:"When the conversation is queued, this information can still be updated and the queue can be changed using -"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Update conversation"})," ",(0,a.jsx)(n.a,{href:"/actions-events/reference/putcctransaction",children:"Update conversation"})]}),"\n",(0,a.jsxs)(n.p,{children:["Once the conversation has reached an agent, the follow notification will be received from # ",(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"AGENT JOINED"})})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{  \n  "eventType": "AGENT_JOINED",  \n  "messageType": "SYSTEM",  \n  "conversationId": "ID-0",  \n  "timestamp": 0,  \n  "agentId": "string",  \n  "agentName": "string"  \n}\n\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Then, when the agent is typing a message, the following activity will be sent # ",(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"ACTIVITY"})})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "eventType": "ACTIVITY",\n  "conversationId": "ID-0",\n  "timestamp": 0,\n  "data": {\n    "name": "typing",\n    "value": {\n      "users": [\n        {\n          "type": "agent",\n          "id": "string"\n        }\n      ]\n    }\n  }\n}\n\n'})}),"\n",(0,a.jsx)(n.p,{children:"The conversation will then be ongoing between the agent and the customer."}),"\n",(0,a.jsxs)(n.p,{children:["An agent sends a message, this will be received on the message activity with the conversationID # ",(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"MESSAGE"})})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "eventType": "MESSAGE",\n  "conversationId": "ID-0",\n  "timestamp": 0,\n  "data": {\n    "isEcho": true,\n    "sender": {\n      "id": "string",\n      "type": ""\n    }\n\n'})}),"\n",(0,a.jsx)(n.p,{children:"Then, a message can be sent back in, using the conversation ID,"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:' "authorType": "user",\n "text": "Hello, I\'m sending a message"\n\n'})}),"\n",(0,a.jsx)(n.h2,{id:"note",children:"Note"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\ud83d\udcd8 ",(0,a.jsx)(n.strong,{children:"To enhance the experience of the customer, we recommend you leverage these Contact Center API's as well -"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/analytics/docs/cc-realtime-statistics",children:"Real Time Statistics Reporting API"}),", to retrieve customer information, make routing decisions."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://support.8x8.com/cloud-contact-center/8x8-contact-center/developers/what-is-the-8x8-contact-center-tenant-provisioning-api",children:"Tenant Schedule API"}),", to ensure the Contact Center is open and receiving queries before handing the query off to an agent."]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}}}]);