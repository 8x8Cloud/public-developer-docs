"use strict";(self.webpackChunk_8x8_developer_docs=self.webpackChunk_8x8_developer_docs||[]).push([[77868],{4543:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"connect/docs/tutorial-add-an-opt-out-keyword-sms","title":"Tutorial: Opt Out Keyword (SMS)","description":"Overview","source":"@site/docs/connect/docs/tutorial-add-an-opt-out-keyword-sms.md","sourceDirName":"connect/docs","slug":"/connect/docs/tutorial-add-an-opt-out-keyword-sms","permalink":"/connect/docs/tutorial-add-an-opt-out-keyword-sms","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebarConnectDocs","previous":{"title":"Troubleshooting","permalink":"/connect/docs/troubleshooting"},"next":{"title":"Tutorial: Opt Out Keyword (Messaging Apps / WhatsApp)","permalink":"/connect/docs/tutorial-add-an-opt-out-keyword-whatsapp"}}');var o=s(74848),i=s(28453);const a={},r="Tutorial: Opt Out Keyword (SMS)",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Contacts API operates at the Account-level",id:"contacts-api-operates-at-the-account-level",level:3},{value:"Contacts API blacklist syncs hourly",id:"contacts-api-blacklist-syncs-hourly",level:3},{value:"Tutorial Steps",id:"tutorial-steps",level:2},{value:"Create Opt-Out Group",id:"create-opt-out-group",level:3},{value:"Get Opt Out group ID",id:"get-opt-out-group-id",level:3},{value:"Pre-Built Template",id:"pre-built-template",level:3},{value:"Opt-Out Template",id:"opt-out-template",level:3},{value:"Building the Workflow",id:"building-the-workflow",level:3},{value:"Deciding the Keyword",id:"deciding-the-keyword",level:3},{value:"Add Contact to Contact Group",id:"add-contact-to-contact-group",level:3},{value:"Opt Out Message",id:"opt-out-message",level:3},{value:"Testing",id:"testing",level:3},{value:"Removing from Group",id:"removing-from-group",level:3}];function l(e){const t={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"tutorial-opt-out-keyword-sms",children:"Tutorial: Opt Out Keyword (SMS)"})}),"\n",(0,o.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(t.p,{children:"This tutorial will show you how to use Automation Builder to build an opt-out flow for SMS."}),"\n",(0,o.jsx)(t.h2,{id:"limitations",children:"Limitations"}),"\n",(0,o.jsx)(t.h3,{id:"contacts-api-operates-at-the-account-level",children:"Contacts API operates at the Account-level"}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.strong,{children:"Contacts API"})," is designed to function at the ",(0,o.jsx)(t.strong,{children:"Account-level"})," and does NOT support operation at the ",(0,o.jsx)(t.strong,{children:"Subaccount"})," level. Contacts added to blacklist groups will be blacklisted across the ",(0,o.jsx)(t.strong,{children:"entire Account, affecting all Subaccounts"})," hence it is not recommended for use cases where you may need to manage separate opt out lists per subaccount. If you need opt-out management at the Subaccount level, you'll have to handle it separately using a third-party system. Please see ",(0,o.jsx)(t.a,{href:"tutorial-opt-out-keyword-messaging-apps-whatsapp-for-third-party-system",children:"this"})," related tutorial for ideas on how to integrate with third-party systems."]}),"\n",(0,o.jsx)(t.h3,{id:"contacts-api-blacklist-syncs-hourly",children:"Contacts API blacklist syncs hourly"}),"\n",(0,o.jsx)(t.p,{children:"The Contacts API's blacklist sync occurs hourly. Consequently, customers added to a blacklist group may continue to receive messages until the sync process updates our system."}),"\n",(0,o.jsx)(t.h2,{id:"tutorial-steps",children:"Tutorial Steps"}),"\n",(0,o.jsx)(t.p,{children:"8x8 has already pre-built an Automation Builder template which allows you to add a keyword which will allow customers to opt out of further communications. We will use this template as the basis of the tutorial."}),"\n",(0,o.jsx)(t.p,{children:"There is setup work we need to do which is covered in the tutorial such as creating the opt-out group via Contacts and obtaining the opt-out group's ID via the Contact API."}),"\n",(0,o.jsx)(t.h3,{id:"create-opt-out-group",children:"Create Opt-Out Group"}),"\n",(0,o.jsxs)(t.p,{children:["Visit the ",(0,o.jsx)(t.a,{href:"https://connect.8x8.com/messaging/contacts",children:"Contacts"}),' page in Connect where we will create a new group. Once on this page below, click into "Contact Groups" and hit the red ',(0,o.jsx)(t.strong,{children:"Create Group"})," button."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(29381).A+"",width:"1134",height:"400"})}),"\n",(0,o.jsx)(t.p,{children:'We should be seeing the screen below, you can fill in any values for the Group Name and Description, but ensure that "Blacklisted" is checked since this controls whether the user is sent messages after being added to the group.'}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(12930).A+"",width:"1102",height:"534"})}),"\n",(0,o.jsx)(t.h3,{id:"get-opt-out-group-id",children:"Get Opt Out group ID"}),"\n",(0,o.jsxs)(t.p,{children:["Once the group is created, we will need to find the Group ID. The Group ID can be obtained via the Contacts API. You can use the group name to search for it. Please see the ",(0,o.jsx)(t.a,{href:"/connect/reference/search-groups",children:"documentation"}),' for the "Search for Groups" endpoint for further information.']}),"\n",(0,o.jsx)(t.p,{children:"The URL for the request should be similar to this format with account name and full or partial group name substituted with your values."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-text",children:"https://contacts.8x8.com/api/v1/accounts/<Account Name>/groups?name=<full or partial group name>\n"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(24677).A+"",width:"743",height:"213"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(56412).A+"",width:"601",height:"590"})}),"\n",(0,o.jsx)(t.p,{children:"The response body will contain a JSON object, the first item in the array should contain your new group, note down the id which in this case is 11344 but may be different. Note down what your group id is for subsequent steps."}),"\n",(0,o.jsx)(t.h3,{id:"pre-built-template",children:"Pre-Built Template"}),"\n",(0,o.jsx)(t.p,{children:'First go to the Automation Builder page and select the blue button for "Create Custom Workflow"'}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(26308).A+"",width:"1724",height:"460"})}),"\n",(0,o.jsx)(t.h3,{id:"opt-out-template",children:"Opt-Out Template"}),"\n",(0,o.jsx)(t.p,{children:'From the pop up in the next page, select "Opt-Out"'}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(61793).A+"",width:"1501",height:"695"})}),"\n",(0,o.jsx)(t.h3,{id:"building-the-workflow",children:"Building the Workflow"}),"\n",(0,o.jsx)(t.p,{children:'In the next page the workflow should be pre-populated with steps, click on the "Trigger" step which is the first step in the flow. Select the subaccount which has the Messaging Apps (Previously known as Chat Apps) number or account that you wish to associate with this opt-out flow. Once it is selected click "Update" to save it to the step.'}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(15528).A+"",width:"1167",height:"833"})}),"\n",(0,o.jsx)(t.h3,{id:"deciding-the-keyword",children:"Deciding the Keyword"}),"\n",(0,o.jsx)(t.p,{children:'The keyword is controlled by the "Branch" Step in red, you can modify this if you wish to change the condition to trigger the opt out.'}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(98656).A+"",width:"531",height:"1584"})}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsx)(t.p,{children:'\ud83d\udcd8 Note: The default workflow will try to detect the presence of "STOP" in every message and it is case sensitive.'}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Once the keyword for opt-out is decided the next step will show the HTTP Request to add a Contact to the blacklisted contact group."}),"\n",(0,o.jsx)(t.h3,{id:"add-contact-to-contact-group",children:"Add Contact to Contact Group"}),"\n",(0,o.jsx)(t.p,{children:"Once that is done, you can move on to modifying the HTTP Request itself."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(43096).A+"",width:"403",height:"1649"})}),"\n",(0,o.jsx)(t.p,{children:"The values should mostly be in place, however you will need to replace the request body with the version below which has the Group ID that you saved earlier substituted."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Field"}),(0,o.jsx)(t.th,{children:"Value"})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Step Name"}),(0,o.jsx)(t.td,{children:"Any Value"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"URL"}),(0,o.jsxs)(t.td,{children:["POST ",(0,o.jsx)(t.a,{href:"https://contacts.8x8.com/api/v1/accounts/contacts",children:"https://contacts.8x8.com/api/v1/accounts/contacts"})]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Header - Content Type"}),(0,o.jsx)(t.td,{children:"application/json"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Header - Authorisation"}),(0,o.jsx)(t.td,{children:"Bearer"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Request Body"}),(0,o.jsxs)(t.td,{children:["{",(0,o.jsx)(t.br,{}),'"groups": [',(0,o.jsx)(t.br,{}),"{",(0,o.jsx)(t.br,{}),'"id": ',(0,o.jsx)(t.br,{}),"}",(0,o.jsx)(t.br,{}),"],",(0,o.jsx)(t.br,{}),'"addresses": {',(0,o.jsx)(t.br,{}),'"msisdn": "{{data.payload.recipient.channelId}}"',(0,o.jsx)(t.br,{}),"}",(0,o.jsx)(t.br,{}),"}"]})]})]})]}),"\n",(0,o.jsxs)(t.p,{children:["Note as usual your API key can be obtained from the API Keys ",(0,o.jsx)(t.a,{href:"https://connect.8x8.com/messaging/api-keys",children:"section"})," of the Connect Dashboard."]}),"\n",(0,o.jsx)(t.h3,{id:"opt-out-message",children:"Opt Out Message"}),"\n",(0,o.jsx)(t.p,{children:"For Opt Out Messaging, the default message only mentions SMS, however the contact blacklist works across SMS and Messaging Apps (formerly Chat Apps) so you can replace the message with the channels that you use to communicate with the customer."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(4714).A+"",width:"488",height:"1056"})}),"\n",(0,o.jsx)(t.p,{children:"After saving these changes, the opt out flow can be enabled by enabling the button at the top left and saving. It will activate immediately and any message that contains the keyword will result in a user being added to the opt-out group."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(89795).A+"",width:"595",height:"441"})}),"\n",(0,o.jsx)(t.h3,{id:"testing",children:"Testing"}),"\n",(0,o.jsx)(t.p,{children:"Once the automation workflow is in place, you can test it by sending the opt-out keyword via SMS to the phone number attached to your subaccount."}),"\n",(0,o.jsx)(t.h3,{id:"removing-from-group",children:"Removing from Group"}),"\n",(0,o.jsxs)(t.p,{children:["In order to remove a customer from a blacklist, you can either manually remove them by visiting the Contact Groups ",(0,o.jsx)(t.a,{href:"https://connect.8x8.com/messaging/contacts",children:"page"})," by visiting their contact details and change their groups."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"image",src:s(6953).A+"",width:"744",height:"615"})}),"\n",(0,o.jsxs)(t.p,{children:["Another option is you can use the ",(0,o.jsx)(t.a,{href:"/connect/reference/delete-contacts-from-group",children:"API to remove a contact"})," from a group."]}),"\n",(0,o.jsx)(t.p,{children:"In either case after removing the contact from the Opt-Out group, you can shortly begin sending messages to them again."})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},4714:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/623e60c-image-d1717db2c3439306c6b6858b492540d5.png"},6953:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/fff26d8-image-d7dde13adc2942dd3057a459837dde54.png"},12930:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/83ef638-image-a08cdb93cf51695b606ac640e6ec6dc7.png"},15528:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/a82702c-image-46f859e1daeba3debed29b9ea8a3d7bf.png"},24677:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/77f1706-image-1afefa92403ed47228f9b610eeea5f8a.png"},26308:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/ee8fa19-image-ef733599e32341e3c8eb236abd4d315e.png"},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>r});var n=s(96540);const o={},i=n.createContext(o);function a(e){const t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(i.Provider,{value:t},e.children)}},29381:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/2a52aeb-image-5c942f827728e53a791b07547d670815.png"},43096:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/8e76b72-image-b41e470d54425e0761ef43e57c343410.png"},56412:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/22c1d2e-image-16691a395611367496dc1c60725cf79a.png"},61793:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/048deb9-image-3173dbd3c45c044b8c710a53624d82d4.png"},89795:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/6ab46c8-image-aa2e9033bbcebce14d5f1dd987495059.png"},98656:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/02922d4-image-593056a9560ef7a386206d8420f25908.png"}}]);