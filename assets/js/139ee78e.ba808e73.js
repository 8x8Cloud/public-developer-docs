"use strict";(self.webpackChunk_8x8_developer_docs=self.webpackChunk_8x8_developer_docs||[]).push([[63064],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var l=s(96540);const a={},i=l.createContext(a);function o(e){const n=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),l.createElement(i.Provider,{value:n},e.children)}},29001:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/af71269-image-3a726fd8afdf7e54e759ab063de35531.png"},40783:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"connect/docs/simple-ivr","title":"Simple IVR","description":"Below is a sample of a simple IVR call scenario. The Callflow below demonstrates an example scenario where a callback is placed to a customer seeking technical support. Then in the same call the user has the ability to either contact a member of technical support, end the call or repeat the main menu.","source":"@site/docs/connect/docs/simple-ivr.md","sourceDirName":"connect/docs","slug":"/connect/docs/simple-ivr","permalink":"/connect/docs/simple-ivr","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebarConnectReference","previous":{"title":"Webhook Setup Guide for IVR","permalink":"/connect/docs/webhook-setup-guide-for-ivr-"},"next":{"title":"Get speech profiles for your account","permalink":"/connect/reference/get-voice-profile-information"}}');var a=s(74848),i=s(28453);const o={},t="Simple IVR",r={},c=[{value:"Demo Video",id:"demo-video",level:2},{value:"GitHub Repo with Sample Backend Code",id:"github-repo-with-sample-backend-code",level:2},{value:"Diagram of Simple IVR Flow",id:"diagram-of-simple-ivr-flow",level:2},{value:"Webhooks and API Calls in Simple IVR Flow",id:"webhooks-and-api-calls-in-simple-ivr-flow",level:2},{value:"Example of initial API call to place outbound call",id:"example-of-initial-api-call-to-place-outbound-call",level:2},{value:"Example Response Body for an Callflows API request",id:"example-response-body-for-an-callflows-api-request",level:3},{value:"Explaining Session Status in Callflows Response Body",id:"explaining-session-status-in-callflows-response-body",level:3},{value:"Status Code and Status Message",id:"status-code-and-status-message",level:3},{value:"VCA Webhook Example",id:"vca-webhook-example",level:2},{value:"DTMF Input 1 - Hangup",id:"dtmf-input-1---hangup",level:3},{value:"DTMF Input 2 - Connect Call",id:"dtmf-input-2---connect-call",level:3},{value:"DTMF Input Other - Repeat Menu",id:"dtmf-input-other---repeat-menu",level:3},{value:"Voice Session Summary Webhook",id:"voice-session-summary-webhook",level:2},{value:"Glossary of Callflow Actions used in a successful Voice Messaging call scenario",id:"glossary-of-callflow-actions-used-in-a-successful-voice-messaging-call-scenario",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",iframe:"iframe",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"simple-ivr",children:"Simple IVR"})}),"\n",(0,a.jsx)(n.p,{children:"Below is a sample of a simple IVR call scenario. The Callflow below demonstrates an example scenario where a callback is placed to a customer seeking technical support. Then in the same call the user has the ability to either contact a member of technical support, end the call or repeat the main menu."}),"\n",(0,a.jsx)(n.h2,{id:"demo-video",children:"Demo Video"}),"\n",(0,a.jsx)(n.p,{children:"This video will show a demo of how the Advanced IVR menu will work, including showing webhooks and the Initial API Call."}),"\n",(0,a.jsx)(n.iframe,{src:"https://www.youtube.com/embed/6UfWfvk8-jY?si=0Embr27hn_krsgKX",height:"500px",width:"100%",allow:"picture-in-picture; web-share",allowFullScreen:!0,children:"\n"}),"\n",(0,a.jsx)(n.h2,{id:"github-repo-with-sample-backend-code",children:"GitHub Repo with Sample Backend Code"}),"\n",(0,a.jsx)(n.p,{children:"In order to make use of the Callflows API, you will need to setup not only Webhooks but a backend server to respond to those webhooks. We have provided a code sample of backend code in Python that processes the webhooks and responds to them to trigger actions in the IVR."}),"\n",(0,a.jsx)(n.p,{children:"Note: The code for the Simple IVR is under app_simple_ivr.py"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://github.com/EMChamp/8x8-advanced-ivr-callsflow-api",children:"GitHub Repo"})}),"\n",(0,a.jsx)(n.h2,{id:"diagram-of-simple-ivr-flow",children:"Diagram of Simple IVR Flow"}),"\n",(0,a.jsx)(n.p,{children:"Below is a description of the IVR Tree that we will be building with this call scenario. There are 3 possible paths and only 1 level in this simple IVR Tree."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image",src:s(29001).A+"",width:"801",height:"223"})}),"\n",(0,a.jsx)(n.h2,{id:"webhooks-and-api-calls-in-simple-ivr-flow",children:"Webhooks and API Calls in Simple IVR Flow"}),"\n",(0,a.jsx)(n.p,{children:"Below is a diagram of how the webhooks and API Calls from your server will work with the 8x8 Voice Platform to create this IVR."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Callsflow IVR Diagrams",src:s(94678).A+"",width:"1159",height:"320"})}),"\n",(0,a.jsx)(n.h2,{id:"example-of-initial-api-call-to-place-outbound-call",children:"Example of initial API call to place outbound call"}),"\n",(0,a.jsx)(n.p,{children:"This is the URL to send the initial API request to."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"POST voice.wavecell.com/api/v1/subaccounts/{sub-account-id}/callflows"})," - v1.2"]}),"\n",(0,a.jsx)(n.p,{children:"This is the request body to send the API request to as well. Note, you will need to replace the source with a 8x8 virtual number in your account and destination with a destination phone number to call."}),"\n",(0,a.jsx)(n.p,{children:"Sample of Simple IVR Request"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "callflow": [\n          {\n            "action": "makeCall",\n            "params": {\n              "source": "6561115777",\n              "destination": "6512345678"\n              }\n        },\n        {\n          "action": "sayAndCapture",\n          "params": {\n              "promptMessage": "Dear customer, Thank you for contacting Xyz technical support recently. If you have resolved your issue already, press one. Or press two to speak to an agent.",\n              "voiceProfile": "en-US-BenjaminRUS",\n              "repetition": 1,\n              "speed": 1,\n              "minDigits": 1,\n              "maxDigits": 1,\n              "digitTimeout": 10000,\n              "overallTimeout": 10000,\n              "completeOnHash": false,\n              "noOfTries": 2,\n              "successMessage": null,\n              "failureMessage": "Invalid input, please try again"\n              }\n        }\n    ]\n}\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"example-response-body-for-an-callflows-api-request",children:"Example Response Body for an Callflows API request"}),"\n",(0,a.jsx)(n.p,{children:"Below are examples of successful and failure responses to the API request above. Depending on the error the status message may change."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Success"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "sessionId": "d9874358-89ac-4c50-bbab-1eb634482a94",\n    "sessionStatus": "CREATED",\n    "callFlowRequestId": "89b545a5-0676-11ee-8100-d500c0d203fc",\n    "statusCode": 1,\n    "statusMessage": "Created"\n}\n\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Failure"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "sessionStatus": "NOT_CREATED",\n    "callFlowRequestId": "0564e804-0a7e-11ee-9c83-6df9c048a122",\n    "statusCode": -1002,\n    "statusMessage": "Speech profile or language parameter invalid"\n}\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"explaining-session-status-in-callflows-response-body",children:"Explaining Session Status in Callflows Response Body"}),"\n",(0,a.jsx)(n.p,{children:"Session status indicates if a call is successfully accepted & created or not created on the 8x8 platform. 8x8 returns two status:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"CREATED"}),"- call is successfully created on the platform."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"NOT CREATED"}),"- call is not successfully created on the platform and 8x8 returns ",(0,a.jsx)(n.code,{children:"statusCode"})," and ",(0,a.jsx)(n.code,{children:"statusMessage"})," to understand why the call was not accepted on the platform"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"status-code-and-status-message",children:"Status Code and Status Message"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Status Code"}),(0,a.jsx)(n.th,{children:"Message"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"1"}),(0,a.jsx)(n.td,{children:"Created"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"-1001"}),(0,a.jsx)(n.td,{children:"Invalid JSON request body"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"-1002"}),(0,a.jsx)(n.td,{children:"Speech profile or language parameter invalid"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"-1003"}),(0,a.jsx)(n.td,{children:"Valid maxDigits required when minDigits provided"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"-1005"}),(0,a.jsx)(n.td,{children:"Valid overallTimeout is required when digitTimeout provided"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"-1007"}),(0,a.jsxs)(n.td,{children:["$.callflow[0].action should be one of: [Call action names]",(0,a.jsx)(n.br,{}),"Eg: ",(0,a.jsx)(n.code,{children:"$.callflow[0].action should be one of: say,playFile,sayAndCapture"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"-1008"}),(0,a.jsx)(n.td,{children:"Valid maxDigits is required when completeOnHash is false"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"-1009"}),(0,a.jsxs)(n.td,{children:["Invalid call flow entry provided. [Additional error details here].",(0,a.jsx)(n.br,{}),"Eg: Invalid call flow entry provided. $.callflow[0].params.text: is missing but it is required"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"-9999"}),(0,a.jsx)(n.td,{children:"An unknown error has occurred"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"vca-webhook-example",children:"VCA Webhook Example"}),"\n",(0,a.jsxs)(n.p,{children:["Once the initial call is made and the user responds with a DTMF input, the server will be sent a ",(0,a.jsx)(n.a,{href:"/connect/reference/voice-message-copy#voice-call-action",children:"VCA"})," webhook which will contain the DTMF input as part of the response body:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "payload": {\n    "eventId": "ddc1e44a-9a40-11ee-b7e9-838e846e8a11",\n    "callId": "d6333b3f-9a40-11ee-b57c-09a88813d857",\n    "sessionId": "d62f91ba-9a40-11ee-945e-5f476b4334a1",\n    "subAccountId": "InternalDemoCPaaS_8dD15_voice",\n    "callStatus": "DTMF_RECEIVED",\n    "callDirection": "OUTBOUND",\n    "callType": "PSTN",\n    "source": "+6391111111111",\n    "destination": "+6599999999",\n    "sourceFormat": "MSISDN",\n    "destinationFormat": "MSISDN",\n    "sourceCountryCode": "PH",\n    "destinationCountryCode": "SG",\n    "callDuration": 0,\n    "dtmf": "3",\n    "sipCode": 200,\n    "timestamp": "2023-12-14T05:23:08.406Z"\n  },\n  "namespace": "VOICE",\n  "eventType": "CALL_ACTION",\n  "description": "Action request of a call"\n}\n\n'})}),"\n",(0,a.jsxs)(n.p,{children:["This will allow your server to identify the DTMF input and reply with a callflow as the ",(0,a.jsx)(n.a,{href:"/connect/reference/voice-message-copy#voice-call-action",children:"VCA"})," webhook response. Below are examples of Callflow responses. Responding to the VCA webhook with one of these callflows below will trigger the corresponding action."]}),"\n",(0,a.jsx)(n.h3,{id:"dtmf-input-1---hangup",children:"DTMF Input 1 - Hangup"}),"\n",(0,a.jsx)(n.p,{children:"Responding with the callflow below will immediately end the call."}),"\n",(0,a.jsx)(n.p,{children:"Digit 1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "callflow": [\n          {\n          "action": "hangup"\n        }\n    ]\n}\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"dtmf-input-2---connect-call",children:"DTMF Input 2 - Connect Call"}),"\n",(0,a.jsx)(n.p,{children:"Responding with this callflow will connect the existing call to a different number."}),"\n",(0,a.jsx)(n.p,{children:"Digit 2"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "callflow": [\n          {\n          "action": "makeCall",\n          "params": {\n            "source": "6512345678",\n            "destination": "6561115777"\n            }\n        }\n    ]\n}\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"dtmf-input-other---repeat-menu",children:"DTMF Input Other - Repeat Menu"}),"\n",(0,a.jsx)(n.p,{children:"Responding with this callflow will repeat the main menu."}),"\n",(0,a.jsx)(n.p,{children:"Any Other Digit"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "callflow": [\n          {\n          "action": "sayAndCapture",\n          "params": {\n              "promptMessage": "Sorry, we did not understand your response. If you have resolved your issue already, press one. Or press two to speak to an agent.",\n              "voiceProfile": "en-US-BenjaminRUS",\n              "repetition": 1,\n              "speed": 1,\n              "minDigits": 1,\n              "maxDigits": 1,\n              "digitTimeout": 10000,\n              "overallTimeout": 10000,\n              "completeOnHash": false,\n              "noOfTries": 2,\n              "successMessage": null,\n              "failureMessage": "Invalid input, please try again"\n              }\n        }\n    ]\n}\n\n'})}),"\n",(0,a.jsx)(n.h2,{id:"voice-session-summary-webhook",children:"Voice Session Summary Webhook"}),"\n",(0,a.jsxs)(n.p,{children:["Upon termination of the session the session summary(",(0,a.jsx)(n.a,{href:"/connect/reference/session-status",children:"VSS"}),") will be returned via webhook. To learn more about the Voice Session Summary, please ",(0,a.jsx)(n.a,{href:"/connect/reference/session-status",children:"click here"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"glossary-of-callflow-actions-used-in-a-successful-voice-messaging-call-scenario",children:"Glossary of Callflow Actions used in a successful Voice Messaging call scenario"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/connect/docs/makecall",children:(0,a.jsx)(n.code,{children:"makecall"})})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/connect/reference/call-flow-actions-sayandcapture",children:(0,a.jsx)(n.code,{children:"sayAndCapture"})})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/connect/docs/hangup",children:(0,a.jsx)(n.code,{children:"hangup"})})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/connect/reference/create-a-new-webhook",children:"Configured your Voice Call Action[VCA] webhook"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},94678:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/b5b94b4-Callsflow_IVR_Diagrams.drawio_1-fb8fa5326f5fc7ca80e331b84e4f9957.png"}}]);