"use strict";(self.webpackChunk_8x8_developer_docs=self.webpackChunk_8x8_developer_docs||[]).push([[82368],{3699:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"connect/docs/context-scripting","title":"Context & Scripting","description":"\ud83d\udea7 [BETA]","source":"@site/docs/connect/docs/context-scripting.md","sourceDirName":"connect/docs","slug":"/connect/docs/context-scripting","permalink":"/connect/docs/context-scripting","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebarConnectReference","previous":{"title":"Branches","permalink":"/connect/docs/getting-started-with-automation-api-1"},"next":{"title":"Time zone & Onboarding","permalink":"/connect/docs/time-zone-onboarding"}}');var r=t(74848),o=t(28453);const i={},a="Context & Scripting",c={},l=[{value:"Context",id:"context",level:2},{value:"Scripting",id:"scripting",level:2}];function d(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"context--scripting",children:"Context & Scripting"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\ud83d\udea7 ",(0,r.jsx)(n.strong,{children:"[BETA]"})]}),"\n",(0,r.jsx)(n.p,{children:"This product is currently in early access. Please reach out to your account manager to get more information."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"context",children:"Context"}),"\n",(0,r.jsxs)(n.p,{children:["Workflow context captures the scope in which a workflow is run. Workflow context persists data between steps that you can read from or write to at runtime. Workflow context exposes two state variables ",(0,r.jsx)(n.strong,{children:"data"})," and ",(0,r.jsx)(n.strong,{children:"step. data"})," is where all workflow-level data is stored. ",(0,r.jsx)(n.strong,{children:"step"})," is where all the step-level data is stored. When the step has completed execution, step data is automatically cleared. So, if you want to capture data from a step to use at a later time, you need to save it to ",(0,r.jsx)(n.strong,{children:"data"}),". You can interact with the workflow context using the inputs and outputs in the step definitions."]}),"\n",(0,r.jsxs)(n.p,{children:["Suppose you have a property in a step A called ",(0,r.jsx)(n.strong,{children:"status"})," which you want to use in a branch step later on. In order for the branch step to access this value, you need to output the value from step A to workflow context like"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "outputs": {\n    "custom_status": "{{step.status}}"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Now, your workflow ",(0,r.jsx)(n.strong,{children:"data"})," has a property named ",(0,r.jsx)(n.strong,{children:"custom_status"})," that you access from any other step like"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "selectNextStep": {\n    "branchA": "{{data.custom_status == \'OK\'}}",\n    "branchB": null\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"data"})," can also store complex objects. For example, a workflow triggered by an outbound message may have nested properties like"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "payload": {\n    "status": {\n      "code": 1001,\n      "errors": ["first error", "second error"]\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["and you can access this code in your workflow context by using ",(0,r.jsx)(n.strong,{children:"data.payload.status.code"})," and first error by using ",(0,r.jsx)(n.strong,{children:"data.payload.status.errors[0]"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"scripting",children:"Scripting"}),"\n",(0,r.jsxs)(n.p,{children:["Automation service has rich support for scripting with JavaScript (supports most features of ECMAScript 2023) via input and output pipelines in the workflow context like member access operators (",(0,r.jsx)(n.strong,{children:"data.member"}),", ",(0,r.jsx)(n.strong,{children:"data['test']['key']"}),"), binary and tertiary operators like ",(0,r.jsx)(n.strong,{children:"x == y ? 1 : 0;"})," and the following functions we have defined for you."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Check country code of a phone number using ",(0,r.jsx)(n.strong,{children:"isCountryCode(phoneNumber, countryCode)"}),". For example, ",(0,r.jsx)(n.strong,{children:"isCountryCode('+6512345678', 'SG')"})," evaluates to ",(0,r.jsx)(n.strong,{children:"true"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Check if text contains a substring using  ",(0,r.jsx)(n.strong,{children:"stringContains(source,value,ignoreCase)"})," For example, ",(0,r.jsx)(n.strong,{children:'stringContains("hello, world","wor",true)'})," evaluates to ",(0,r.jsx)(n.strong,{children:"true"}),".  The ",(0,r.jsx)(n.strong,{children:"ignoreCase"})," param will ignore case-sensitivity is set to true. If ",(0,r.jsx)(n.strong,{children:"ignoreCase"})," is not set then the default is ",(0,r.jsx)(n.strong,{children:"false"})," which means it will be case-sensitive."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Check if a timestamp falls within some time of the day for the specified time zone using ",(0,r.jsx)(n.strong,{children:"isTimeOfDayBetween(timestamp, timeFrom, timeTo, timezone)"}),". For example, ",(0,r.jsxs)(n.strong,{children:["isTimeOfDayBetween('2020-10-15T14:40:15+07:00', \u201809:00:00', \u201818:00:00\u2019, 'Singapore Standard Time\u2019) ** evaluates to ",(0,r.jsx)(n.strong,{children:"true"}),". Refer to Time Zones resource for supported timezones.",(0,r.jsx)(n.br,{}),"\nTo check if a timestamp falls outside a specific time interval you can either specify it as two time intervals chained with an"]})," || ",(0,r.jsx)(n.strong,{children:"(logical OR) condition or a negation"})," ! ",(0,r.jsxs)(n.strong,{children:["(logical NOT) on a single time interval. For example, ",(0,r.jsx)(n.strong,{children:"!isTimeOfDayBetween('2020-10-15T14:40:15+07:00', \u201809:00:00', \u201818:00:00\u2019, 'Singapore Standard Time\u2019)"})," is logically equivalent to"]}),"isTimeOfDayBetween('2020-10-15T14:40:15+07:00', \u201800:00:00', \u201808:59:59\u2019, 'Singapore Standard Time\u2019) || isTimeOfDayBetween('2020-10-15T14:40:15+07:00', \u201818:00:01', \u201823:59:59\u2019, 'Singapore Standard Time\u2019)",(0,r.jsx)(n.br,{}),"\n**"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Check the day of the week of a date using ",(0,r.jsx)(n.strong,{children:"isDayOfWeek(date, day)"}),". For example, ",(0,r.jsx)(n.strong,{children:"isDayOfWeek('2021-05-25', 'Tuesday')"})," evaluates to true. The date can be a simple date or a full datetime in the ISO8601 format. Supported days are Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday. The days are not case sensitive. Any of Monday, monday, MONDAY is acceptable."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Scripts must be enclosed in double curly brackets like ",(0,r.jsx)(n.strong,{children:"{{data.msisdn == 6500000000}}"}),". The preceding statement will access the ",(0,r.jsx)(n.code,{children:"msisdn"})," property from workflow context at runtime and check that it equals to 6500000000."]}),"\n",(0,r.jsxs)(n.p,{children:["Scripts for populating strings can be defined like ",(0,r.jsx)(n.strong,{children:"\"{{'umid: ' + data.umid}}\""})," or ",(0,r.jsx)(n.strong,{children:'"umid: {{data.umid}}"'}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Following restrictions are placed on scripts for security reasons:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Maximum length of scripts is 1000 characters."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Assignments, allocations and type declarations are forbidden."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Recursive functions are forbidden."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Scripts that take more than 500 milliseconds to execute are forbidden (configurable)."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var s=t(96540);const r={},o=s.createContext(r);function i(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);