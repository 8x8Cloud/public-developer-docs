"use strict";(self.webpackChunk_8x8_developer_docs=self.webpackChunk_8x8_developer_docs||[]).push([[2508],{15892:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/cf0e856-image-a89c41d73e143b09eea8f16727be95a9.png"},17453:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/3ace9ed-image-8591ab5a43eb94d6f152540133cdfab4.png"},17640:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/7a7c7c7-image-e68df79c789eafbca51ede07ed954974.png"},19916:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/06d0917-image-78ecbd78fd2f09a2a1eed7de6c2a1045.png"},21608:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/1dcaabf-image-c93c8e30d592f1527770e684edddc0cb.png"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var s=n(96540);const a={},i=s.createContext(a);function r(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}},30084:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/fdd93b7-image-414f73a380ad666424f69732249c4c79.png"},35920:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/6065d97-image-713e9678acdd9a9d88db7ab7e3c6c49d.png"},36936:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/3d46132-image-f90231c7e5edce37f07577f3a6a76301.png"},38246:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/e0744e4-image-f6e8c77057b1dccebab79dbdbaf5118b.png"},42705:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/8f2479f-image-c9ff0a349b8245e991bf3669e8b31ab9.png"},45028:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/c548fe6-image-87d978d0a32b03b1ba6dc29c882bcb9c.png"},45385:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/d9d84de-image-91a5e7d06ea77780096d6e24e6322fde.png"},45542:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/a9ad033-image-0799e8f7571d2418077959100c40565d.png"},50050:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/b4cc48a-image-e7c89860afdca69058f6f64380d42f3a.png"},50219:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/9327f92-image-fca7bfcf90ff837c998db95495c30692.png"},51483:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/f0af7e5-image-fccf29db41ce50fcc50307dc3442ac7a.png"},56322:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/b9ec4d8-image-1a40ae2091934f7b2140a77330c58067.png"},64872:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/ac714d3-image-0ab83af76e19faddd5c3179c963b20f1.png"},64999:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/e70ee19-image-12a510da3b4c0d6fd8e76b43f89c434e.png"},65254:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/7df91f8-image-753b0b3b175117fb31126b398d522a8e.png"},69157:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/933c523-image-2f113dd6fb9a3787b54dc249e46dc5e6.png"},74413:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/77b8cc0-image-bb135fe2fb5b72f7c3e2cd5c65e9a568.png"},82144:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"connect/docs/tutorial-building-a-whatsapp-google-calendar-chat-bot","title":"Tutorial: Building a WhatsApp + Google Calendar Chat Bot","description":"This tutorial will show you how to build a WhatsApp + Google Calendar chat bot using 8x8 Automation Builder. The resulting chat bot will allow customers to send a message to a WhatsApp Business Account tied to your 8x8 subaccount and schedule an appointment on Google Calendar.","source":"@site/docs/connect/docs/tutorial-building-a-whatsapp-google-calendar-chat-bot.md","sourceDirName":"connect/docs","slug":"/connect/docs/tutorial-building-a-whatsapp-google-calendar-chat-bot","permalink":"/connect/docs/tutorial-building-a-whatsapp-google-calendar-chat-bot","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebarConnectDocs","previous":{"title":"Tutorial: Building a SMS + ChatApps Reservation Menu","permalink":"/connect/docs/tutorial-automation-builder-sms-chatapps-reservation-menu"},"next":{"title":"Tutorial: Customer Survey via SMS","permalink":"/connect/docs/tutorial-customer-survey-via-sms"}}');var a=n(74848),i=n(28453);const r={},o="Tutorial: Building a WhatsApp + Google Calendar Chat Bot",d={},l=[{value:"Overview",id:"overview",level:2},{value:"Demo Video",id:"demo-video",level:2},{value:"Automation Builder Workflow Steps",id:"automation-builder-workflow-steps",level:2},{value:"Workflow Steps In-Depth",id:"workflow-steps-in-depth",level:2},{value:"1) Chat Apps Trigger",id:"1-chat-apps-trigger",level:3},{value:"2) Chat Apps Message Step - Main Menu",id:"2-chat-apps-message-step---main-menu",level:3},{value:"3) Wait for Reply Step - Reply to Main Menu",id:"3-wait-for-reply-step---reply-to-main-menu",level:3},{value:"4) Branch Step",id:"4-branch-step",level:3},{value:"5a) Chat Apps Message - Enter Email Address",id:"5a-chat-apps-message---enter-email-address",level:3},{value:"5b) Chat Apps Message - Cancellation Message",id:"5b-chat-apps-message---cancellation-message",level:3},{value:"6) Wait for Reply - Email Address",id:"6-wait-for-reply---email-address",level:3},{value:"7) HTTP Request Step - Check for available time slots",id:"7-http-request-step---check-for-available-time-slots",level:3},{value:"8) Chat Apps Message Step - Meeting Timeslots",id:"8-chat-apps-message-step---meeting-timeslots",level:3},{value:"9) Wait For Reply Step - Customer Chooses Timeslot",id:"9-wait-for-reply-step---customer-chooses-timeslot",level:3},{value:"10) Branch Step - Branch based on Chosen Timeslot",id:"10-branch-step---branch-based-on-chosen-timeslot",level:3},{value:"11a,b,c) HTTP Request Step - Reserve Calendar Timeslot Based on the User&#39;s Input",id:"11abc-http-request-step---reserve-calendar-timeslot-based-on-the-users-input",level:3},{value:"11d) Chat Message Step - Cancellation message",id:"11d-chat-message-step---cancellation-message",level:3},{value:"12a,b,c) Chat Apps Message - Calendar Invite Confirmation Message",id:"12abc-chat-apps-message---calendar-invite-confirmation-message",level:3},{value:"Automation Builder - Example JSON",id:"automation-builder---example-json",level:2},{value:"Backend Server - Example Code",id:"backend-server---example-code",level:2},{value:"Code Explanation - API",id:"code-explanation---api",level:3},{value:"Code Explanation - Retrieve Events",id:"code-explanation---retrieve-events",level:3},{value:"Code Explanation - Create Event",id:"code-explanation---create-event",level:3},{value:"Google Calendar Organizational Use",id:"google-calendar-organizational-use",level:3}];function c(e){const t={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",iframe:"iframe",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"tutorial-building-a-whatsapp--google-calendar-chat-bot",children:"Tutorial: Building a WhatsApp + Google Calendar Chat Bot"})}),"\n",(0,a.jsx)(t.p,{children:"This tutorial will show you how to build a WhatsApp + Google Calendar chat bot using 8x8 Automation Builder. The resulting chat bot will allow customers to send a message to a WhatsApp Business Account tied to your 8x8 subaccount and schedule an appointment on Google Calendar."}),"\n",(0,a.jsx)(t.p,{children:"The concepts in this guide are useful as a stepping stone to understand how Automation Builder can be used with other systems that expose APIs to create richer experiences with the 8x8 Chat Apps API."}),"\n",(0,a.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(t.p,{children:"There are two components to this project:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Automation Builder workflow"})," which will be built on the ",(0,a.jsx)(t.a,{href:"https://connect.8x8.com/",children:"Connect"})," Dashboard. The workflow takes care of orchestrating responses through WhatsApp."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Backend Server"})," we have provided example server ",(0,a.jsx)(t.a,{href:"https://github.com/EMChamp/8x8-google-calendar-wa-scheduler",children:"code"})," in Python for the Scheduling service described in this diagram. The Backend Server API allows us to connect to the Google Calendar API and also run some scheduling logic based on the responses."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(36936).A+"",width:"8270",height:"5320"})}),"\n",(0,a.jsx)(t.h2,{id:"demo-video",children:"Demo Video"}),"\n",(0,a.jsx)(t.p,{children:"Please see a demo video of the WhatsApp Chatbot below."}),"\n",(0,a.jsx)(t.iframe,{src:"https://www.youtube.com/embed/Vv6ruAbdpgs?si=H9YyplFou8hIGlJr",height:"500px",width:"100%",allow:"picture-in-picture; web-share",allowFullScreen:!0,children:"\n"}),"\n",(0,a.jsx)(t.h2,{id:"automation-builder-workflow-steps",children:"Automation Builder Workflow Steps"}),"\n",(0,a.jsx)(t.p,{children:"Here is a visual overview of the complete automation builder workflow, we will cover each step in depth in the following section of the tutorial."}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Customer messages WhatsApp Business Account which triggers the workflow."}),"\n",(0,a.jsx)(t.li,{children:"Chat Apps Message Sends Main Menu to Customer"}),"\n",(0,a.jsx)(t.li,{children:"Wait for Customer Reply"}),"\n",(0,a.jsx)(t.li,{children:"Check for customer response and branch based on that."}),"\n",(0,a.jsx)(t.li,{children:"Respond according to user's chosen option"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"a. Prompt user for Email Address"}),"\n",(0,a.jsx)(t.p,{children:"b. Send Goodbye message if flow is cancelled.\n6. Wait for user reply to email address, in order to save as an output variable for use later in workflow.\n7. Send API request to our Backend API to check for available Calendar Timeslots.\n8. Share Available Timeslots through WhatsApp as a list.\n9. Wait for customer to choose available timeslot from list.\n10. Branch based on user's chosen timeslot\n11. a/b/c. Send API request to book timeslot based on user's chosen timeslot."}),"\n",(0,a.jsx)(t.p,{children:"d. Send Cancellation Message through WhatsApp.\n12. a/b/c. Send Confirmation message based on user's chosen timeslot."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(74413).A+"",width:"357",height:"1003"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(21608).A+"",width:"622",height:"1679"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(38246).A+"",width:"1212",height:"1080"})}),"\n",(0,a.jsx)(t.h2,{id:"workflow-steps-in-depth",children:"Workflow Steps In-Depth"}),"\n",(0,a.jsx)(t.h3,{id:"1-chat-apps-trigger",children:"1) Chat Apps Trigger"}),"\n",(0,a.jsx)(t.p,{children:"This trigger is responsible for kicking off the workflow, by default it will be triggered when any inbound chat apps message is received on the WABA tied to the subaccount you select below."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(91229).A+"",width:"220",height:"136"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(83212).A+"",width:"439",height:"511"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Trigger"}),(0,a.jsx)(t.td,{children:"Inbound Chat Apps"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a new subaccount"}),(0,a.jsx)(t.td,{children:"Select the subaccount with the WABA you would like to send from."})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"2-chat-apps-message-step---main-menu",children:"2) Chat Apps Message Step - Main Menu"}),"\n",(0,a.jsx)(t.p,{children:"This Chat Apps Message Step introduces the main menu that will start off with a simple welcome message and then display a menu with 2 options for the customer to select from."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(51483).A+"",width:"468",height:"312"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(50219).A+"",width:"434",height:"961"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Step Name"}),(0,a.jsxs)(t.td,{children:["This is autofilled, the step name can optionally be changed for easier readability.",(0,a.jsx)(t.strong,{children:"Note:"}),"  For the sake of brevity, we will ignore the Step Name field for subsequent steps in this tutorial as the recommendation is the same for all steps."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a new subaccount"}),(0,a.jsx)(t.td,{children:"Select the subaccount with the WABA you would like to send from."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination"}),(0,a.jsxs)(t.td,{children:[(0,a.jsx)(t.code,{children:"{{data.payload.user.channelUserId}}"}),(0,a.jsx)(t.strong,{children:"Note:"})," This allows us to reply to the user who sent the WhatsApp message, which is what we want in a chatbot scenario."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Select an existing template or compose a new message"}),(0,a.jsxs)(t.td,{children:["Welcome to 8x8's WhatsApp - Google Calendar Demo. This demo will schedule a Google Calendar event with one of our specialists through WhatsApp.",(0,a.jsx)(t.br,{}),"Please choose from the following options:",(0,a.jsx)(t.br,{}),"1. Schedule a 1 hour meeting",(0,a.jsx)(t.br,{}),"2. Exit"]})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"3-wait-for-reply-step---reply-to-main-menu",children:"3) Wait for Reply Step - Reply to Main Menu"}),"\n",(0,a.jsx)(t.p,{children:"This step waits for a customer to reply to the main menu option list, their reply will be used in the following branch step."}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.img,{alt:"image",src:n(42705).A+"",width:"260",height:"193"}),"\n",(0,a.jsx)(t.img,{alt:"image",src:n(93485).A+"",width:"432",height:"573"})]}),"\n",(0,a.jsx)(t.p,{children:"As configured this waits 5 minutes for a customer to reply to the main menu option message in the previous step, however you can change the timeout as desired."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"From"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"{{data.payload.user.channelUserId}}"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a channel"}),(0,a.jsx)(t.td,{children:"WhatsApp"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Timeout"}),(0,a.jsx)(t.td,{children:"5 minutes"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"4-branch-step",children:"4) Branch Step"}),"\n",(0,a.jsx)(t.p,{children:"In this step, we branch off two separate paths depending on the response from the WA user."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(45028).A+"",width:"1266",height:"814"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(30084).A+"",width:"618",height:"726"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a condition"}),(0,a.jsx)(t.td,{children:"Check if a value contains a string"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Value to Check"}),(0,a.jsxs)(t.td,{children:["{{data.waitforreply_XXXX_step_text}}",(0,a.jsx)(t.br,{}),"Note: Replace XXXX with the number identifier for your previous waitforreply step, this will be auto generated by the system and will be different for your specific workflow."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Keywords to Compare"}),(0,a.jsx)(t.td,{children:"1, 2"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"5a-chat-apps-message---enter-email-address",children:"5a) Chat Apps Message - Enter Email Address"}),"\n",(0,a.jsx)(t.p,{children:"In this Chat Apps message step we will send a very simple prompt to ask the user to input their email address."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(35920).A+"",width:"313",height:"257"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(85057).A+"",width:"598",height:"744"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination"}),(0,a.jsx)(t.td,{children:"{{data.payload.user.channelUserId}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Select an existing template or compose a new message"}),(0,a.jsx)(t.td,{children:"Check Compose Message"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Message"}),(0,a.jsx)(t.td,{children:"Please enter your email addres"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"5b-chat-apps-message---cancellation-message",children:"5b) Chat Apps Message - Cancellation Message"}),"\n",(0,a.jsx)(t.p,{children:"This step is if the user chooses not to schedule a meeting in the main menu. In that case a cancellation message will be played for the user."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(87176).A+"",width:"287",height:"190"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(56322).A+"",width:"412",height:"772"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a new subaccount"}),(0,a.jsx)(t.td,{children:"Select the subaccount with the WABA you would like to send from."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination"}),(0,a.jsx)(t.td,{children:"{{data.payload.user.channelUserId}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Message"}),(0,a.jsx)(t.td,{children:"Goodbye!"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"6-wait-for-reply---email-address",children:"6) Wait for Reply - Email Address"}),"\n",(0,a.jsx)(t.p,{children:"In the wait for reply step, we will wait for the customer to enter their email address. We give them 1 minute to respond but you can change this value as needed."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(69157).A+"",width:"622",height:"728"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"From"}),(0,a.jsx)(t.td,{children:"{{data.payload.user.channelUserId}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a channel"}),(0,a.jsx)(t.td,{children:"WhatsApp"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Timeout"}),(0,a.jsx)(t.td,{children:"1 Minute"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"7-http-request-step---check-for-available-time-slots",children:"7) HTTP Request Step - Check for available time slots"}),"\n",(0,a.jsxs)(t.p,{children:["This is the first of our HTTP Request Steps that will be hitting our ",(0,a.jsx)(t.strong,{children:"/retrieve_meetings"})," endpoint that is part of our API. This endpoint will return possible meeting timeslots which can then be presented to the user in the subsequent Chat Apps Message Step."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(64999).A+"",width:"510",height:"838"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"URL"}),(0,a.jsx)(t.td,{children:"This should be your server's publically accessible URL"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Header"}),(0,a.jsx)(t.td,{children:"content-type: application/json"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Request Body"}),(0,a.jsx)(t.td,{children:"{}"})]})]})]}),"\n",(0,a.jsx)(t.p,{children:"The outputs of this step is how we save the values from the API response body to be presented to the user. The values match the response body JSON that we will specify in our code."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(19916).A+"",width:"470",height:"782"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"meetings"}),(0,a.jsx)(t.td,{children:"{{step.responseBody.date_options}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"timeslot1_start"}),(0,a.jsx)(t.td,{children:"{{step.responseBody.timeslot1_start}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"timeslot1_end"}),(0,a.jsx)(t.td,{children:"{{step.responseBody.timeslot1_end}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"timeslot2_start"}),(0,a.jsx)(t.td,{children:"{{step.responseBody.timeslot2_start}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"timeslot2_end"}),(0,a.jsx)(t.td,{children:"{{step.responseBody.timeslot2_end}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"timeslot3_start"}),(0,a.jsx)(t.td,{children:"{{step.responseBody.timeslot3_start}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"customer_email"}),(0,a.jsx)(t.td,{children:"{{data.waitforreply_9196_step_text}}"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"8-chat-apps-message-step---meeting-timeslots",children:"8) Chat Apps Message Step - Meeting Timeslots"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(97831).A+"",width:"488",height:"824"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"}),(0,a.jsx)(t.th,{})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a new subaccount"}),(0,a.jsx)(t.td,{children:"Select the subaccount with the WABA you would like to send from."}),(0,a.jsx)(t.td,{})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination"}),(0,a.jsx)(t.td,{children:"{{data.payload.user.channelUserId}}"}),(0,a.jsx)(t.td,{})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Select an existing template or compose a new message"}),(0,a.jsx)(t.td,{children:"Compose Message"}),(0,a.jsx)(t.td,{})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Message"}),(0,a.jsx)(t.td,{children:"{{'Here are the available timeslots. Please enter the number for the option you would like to book. \\n'+ data.meetings + '\\nOption 4: Exit Scheduling'}}"}),(0,a.jsx)(t.td,{})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:["A bit of an explanation for the ",(0,a.jsx)(t.strong,{children:"message"})," field, the entire message is wrapped in curly brackets since we are using the output data.meetings as part of the string. This is combined with the rest of the string in order to produce a message which looks like this:"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(17453).A+"",width:"994",height:"406"})}),"\n",(0,a.jsx)(t.h3,{id:"9-wait-for-reply-step---customer-chooses-timeslot",children:"9) Wait For Reply Step - Customer Chooses Timeslot"}),"\n",(0,a.jsx)(t.p,{children:"This step will wait for a customer to choose from the options presented above."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(97007).A+"",width:"292",height:"384"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"From"}),(0,a.jsx)(t.td,{children:"{{data.payload.user.channelUserId}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a Channel"}),(0,a.jsx)(t.td,{children:"WhatsApp"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Timeout"}),(0,a.jsx)(t.td,{children:"1 Minute"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"10-branch-step---branch-based-on-chosen-timeslot",children:"10) Branch Step - Branch based on Chosen Timeslot"}),"\n",(0,a.jsx)(t.p,{children:"This step will branch based on the customer's input from the previous step. The following steps are HTTP Request steps that will decide what meeting timeslot is booked."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(45542).A+"",width:"1404",height:"499"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(15892).A+"",width:"404",height:"732"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a condition"}),(0,a.jsx)(t.td,{children:"Check if a value contains a string"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Value to Check"}),(0,a.jsx)(t.td,{children:"{{data.waitforreply_XXXX_step_text}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Keyword(s) to compare"}),(0,a.jsx)(t.td,{children:"1,2,3,4"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"11abc-http-request-step---reserve-calendar-timeslot-based-on-the-users-input",children:"11a,b,c) HTTP Request Step - Reserve Calendar Timeslot Based on the User's Input"}),"\n",(0,a.jsx)(t.p,{children:"These three HTTP Request Steps will be tied to the customer's input in the previous step."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(65254).A+"",width:"709",height:"383"})}),"\n",(0,a.jsx)(t.p,{children:"The only difference between these fields will be the numbers used for the timeslot, so the backend server knows what the user chose. For example, we will use {{data.timeslot1_start}} for timeslot 1's start time and then {{data.timeslot2_start}} for timeslot 1's start time."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(17640).A+"",width:"415",height:"805"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"}),(0,a.jsx)(t.th,{})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"URL"}),(0,a.jsx)(t.td,{children:"Your Backend Server's URL"}),(0,a.jsx)(t.td,{})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Request Body"}),(0,a.jsxs)(t.td,{children:["{",(0,a.jsx)(t.br,{}),'"start": "{{data.timeslotX_start}}",',(0,a.jsx)(t.br,{}),'"end": "{{data.timeslotX_end}}",',(0,a.jsx)(t.br,{}),'"customer_email": "{{data.waitforreply_9196_step_text}}"',(0,a.jsx)(t.br,{}),"}",(0,a.jsx)(t.strong,{children:"Note:"})," Replace timeslotX with the timeslot option, such as timeslot1, timeslot2, timeslot3."]}),(0,a.jsx)(t.td,{})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Timeout"}),(0,a.jsx)(t.td,{children:"20 Seconds"}),(0,a.jsx)(t.td,{})]})]})]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(50050).A+"",width:"404",height:"234"})}),"\n",(0,a.jsx)(t.p,{children:"For the output you can save the start_time and end_time for the following confirmation message. The values will be specify to JSON response body of the backend API code that we provide."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"start_time"}),(0,a.jsx)(t.td,{children:"{{step.responseBody.start.dateTime}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"end_time"}),(0,a.jsx)(t.td,{children:"{{step.responseBody.end.dateTime}}"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"11d-chat-message-step---cancellation-message",children:"11d) Chat Message Step - Cancellation message"}),"\n",(0,a.jsx)(t.p,{children:"This step is if the user chooses not to schedule a meeting in the main menu, in that case a cancellation message is played."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(87176).A+"",width:"287",height:"190"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(56322).A+"",width:"412",height:"772"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a new subaccount"}),(0,a.jsx)(t.td,{children:"Select the subaccount with the WABA you would like to send from."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination"}),(0,a.jsx)(t.td,{children:"{{data.payload.user.channelUserId}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Message"}),(0,a.jsx)(t.td,{children:"Goodbye!"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"12abc-chat-apps-message---calendar-invite-confirmation-message",children:"12a,b,c) Chat Apps Message - Calendar Invite Confirmation Message"}),"\n",(0,a.jsx)(t.p,{children:"This step sends a simple confirmation message through WhatsApp and ends the workflow. If a user sends another message after this workflow ends, then it will trigger a fresh workflow instances from the beginning."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(64872).A+"",width:"754",height:"218"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"image",src:n(45385).A+"",width:"403",height:"798"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Field"}),(0,a.jsx)(t.th,{children:"Value"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Please select a new subaccount"}),(0,a.jsx)(t.td,{children:"Select the subaccount with the WABA you would like to send from."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination"}),(0,a.jsx)(t.td,{children:"{{data.payload.user.channelUserId}}"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Message"}),(0,a.jsx)(t.td,{children:"Goodbye!"})]})]})]}),"\n",(0,a.jsx)(t.h2,{id:"automation-builder---example-json",children:"Automation Builder - Example JSON"}),"\n",(0,a.jsx)(t.p,{children:"If you would like to skip building the steps manually above, we have provided an example JSON file to get you started which you can import into Automation Builder. Note that you will have to modify values in the steps according to your specific backend system and also your 8x8 subaccount."}),"\n",(0,a.jsx)(t.p,{children:"Automation Builder JSON"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "definition": {\n    "id": "d2f47259-75ff-45bd-950e-97a5dee631e4",\n    "name": "RS WhatsApp GCal Demo",\n    "version": 25,\n    "steps": [\n      {\n        "stepType": "Branch",\n        "id": "branch_6057",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {},\n        "outputs": {},\n        "selectNextStep": {\n          "chatappsmessage_5822": "{{stringContains(data.payload.content.text, \'RSGoogleCalendarDemo\', true)}}"\n        }\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_5822",\n        "do": [],\n        "nextStepId": "waitforreply_8622",\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "Welcome to 8x8\'s WhatsApp - Google Calendar Demo. This demo will schedule a Google Calendar event with one of our specialists through WhatsApp.\\n\\nPlease choose from the following options:\\n1) Schedule a 1 hour meeting\\n2) Exit"\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "WaitForReply",\n        "id": "waitforreply_8622",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "from": "{{data.payload.user.channelUserId}}",\n          "channel": "whatsapp",\n          "timeout": "0.00:01:00"\n        },\n        "outputs": {\n          "waitforreply_8622_step_text": "{{step.reply.payload.content.text}}"\n        },\n        "selectNextStep": {\n          "branch_8338": "{{ step.reply != null }}",\n          "chatappsmessage_6652": "{{ step.reply == null }}"\n        }\n      },\n      {\n        "stepType": "Branch",\n        "id": "branch_8338",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {},\n        "outputs": {},\n        "selectNextStep": {\n          "chatappsmessage_0501": "{{stringContains(data.waitforreply_8622_step_text, \'1\', true)}}",\n          "chatappsmessage_9836": "{{stringContains(data.waitforreply_8622_step_text, \'2\', true)}}"\n        }\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_6652",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "No Reply Detected within the allotted time, please try again."\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_9836",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "Goodbye!"\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_0501",\n        "do": [],\n        "nextStepId": "waitforreply_9196",\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "Please enter your email address:"\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "WaitForReply",\n        "id": "waitforreply_9196",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "from": "{{data.payload.user.channelUserId}}",\n          "channel": "whatsapp",\n          "timeout": "0.00:01:00"\n        },\n        "outputs": {\n          "waitforreply_9196_step_text": "{{step.reply.payload.content.text}}"\n        },\n        "selectNextStep": {\n          "httprequest_0590": "{{ step.reply != null }}"\n        }\n      },\n      {\n        "stepType": "HttpRequest",\n        "id": "httprequest_0590",\n        "do": [],\n        "nextStepId": "chatappsmessage_7792",\n        "inputs": {\n          "method": "GET",\n          "url": "https://rsunga.ngrok.io/retrieve_meetings",\n          "headers": {\n            "content-Type": "application/json"\n          },\n          "parameters": {},\n          "body": {},\n          "timeoutSeconds": 20\n        },\n        "outputs": {\n          "meetings": "{{step.responseBody.date_options}}",\n          "timeslot1_start": "{{step.responseBody.timeslot1_start}}",\n          "timeslot1_end": "{{step.responseBody.timeslot1_end}}",\n          "timeslot2_start": "{{step.responseBody.timeslot2_start}}",\n          "timeslot2_end": "{{step.responseBody.timeslot2_end}}",\n          "timeslot3_start": "{{step.responseBody.timeslot3_start}}",\n          "timeslot3_end": "{{step.responseBody.timeslot3_end}}",\n          "customer_email": "{{data.waitforreply_9196_step_text}}"\n        },\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_7792",\n        "do": [],\n        "nextStepId": "waitforreply_3750",\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "{{\'Here are the available timeslots. Please enter the number for the option you would like to book. \\\\n\'+ data.meetings + \'\\\\nOption 4: Exit Scheduling\'}}"\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "WaitForReply",\n        "id": "waitforreply_3750",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "from": "{{data.payload.user.channelUserId}}",\n          "channel": "whatsapp",\n          "timeout": "0.00:01:00"\n        },\n        "outputs": {\n          "waitforreply_3750_step_text": "{{step.reply.payload.content.text}}"\n        },\n        "selectNextStep": {\n          "branch_3014": "{{ step.reply != null }}"\n        }\n      },\n      {\n        "stepType": "Branch",\n        "id": "branch_3014",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {},\n        "outputs": {},\n        "selectNextStep": {\n          "httprequest_1190": "{{stringContains(data.waitforreply_3750_step_text, \'1\', true)}}",\n          "httprequest_7087": "{{stringContains(data.waitforreply_3750_step_text, \'2\', true)}}",\n          "httprequest_4260": "{{stringContains(data.waitforreply_3750_step_text, \'3\', true)}}",\n          "chatappsmessage_4941": "{{stringContains(data.waitforreply_3750_step_text, \'4\', true)}}"\n        }\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_4941",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "Goodbye!"\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "HttpRequest",\n        "id": "httprequest_4260",\n        "do": [],\n        "nextStepId": "chatappsmessage_1276",\n        "inputs": {\n          "headers": {\n            "content-Type": "application/json"\n          },\n          "method": "POST",\n          "url": "https://rsunga.ngrok.io/create_meeting",\n          "parameters": {},\n          "body": {\n            "start": "{{data.timeslot3_start}}",\n            "end": "{{data.timeslot3_end}}",\n            "customer_email": "{{data.waitforreply_9196_step_text}}"\n          },\n          "timeoutSeconds": 20\n        },\n        "outputs": {\n          "start_time": "{{step.responseBody.start.dateTime}}",\n          "end_time": "{{step.responseBody.end.dateTime}}"\n        },\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "HttpRequest",\n        "id": "httprequest_7087",\n        "do": [],\n        "nextStepId": "chatappsmessage_1074",\n        "inputs": {\n          "headers": {\n            "content-Type": "application/json"\n          },\n          "method": "POST",\n          "url": "https://rsunga.ngrok.io/create_meeting",\n          "parameters": {},\n          "body": {\n            "start": "{{data.timeslot2_start}}",\n            "end": "{{data.timeslot2_end}}",\n            "customer_email": "{{data.waitforreply_9196_step_text}}"\n          },\n          "timeoutSeconds": 20\n        },\n        "outputs": {\n          "start_time": "{{step.responseBody.start.dateTime}}",\n          "end_time": "{{step.responseBody.end.dateTime}}"\n        },\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "HttpRequest",\n        "id": "httprequest_1190",\n        "do": [],\n        "nextStepId": "chatappsmessage_4345",\n        "inputs": {\n          "method": "POST",\n          "url": "https://rsunga.ngrok.io/create_meeting",\n          "headers": {\n            "content-Type": "application/json"\n          },\n          "parameters": {},\n          "body": {\n            "start": "{{data.timeslot1_start}}",\n            "end": "{{data.timeslot1_end}}",\n            "customer_email": "{{data.waitforreply_9196_step_text}}"\n          },\n          "timeoutSeconds": 20\n        },\n        "outputs": {\n          "start_time": "{{step.responseBody.start.dateTime}}",\n          "end_time": "{{step.responseBody.end.dateTime}}"\n        },\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_1276",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "Your meeting has been booked, please check your email for further details."\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_1074",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "Your meeting has been booked, please check your email for further details."\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      },\n      {\n        "stepType": "ChatAppsMessage",\n        "id": "chatappsmessage_4345",\n        "do": [],\n        "nextStepId": null,\n        "inputs": {\n          "subAccountId": "InternalDemoCPaaS_ChatApps",\n          "type": "text",\n          "content": {\n            "text": "Your meeting has been booked, please check your email for further details.\\n"\n          },\n          "user": {\n            "msisdn": "{{data.payload.user.channelUserId}}"\n          }\n        },\n        "outputs": {},\n        "selectNextStep": {}\n      }\n    ]\n  },\n  "subAccountId": "InternalDemoCPaaS_ChatApps",\n  "trigger": "inbound_chat_apps",\n  "status": "disabled"\n}\n\n'})}),"\n",(0,a.jsx)(t.h2,{id:"backend-server---example-code",children:"Backend Server - Example Code"}),"\n",(0,a.jsxs)(t.p,{children:["Please see the following ",(0,a.jsx)(t.a,{href:"https://github.com/EMChamp/8x8-google-calendar-wa-scheduler",children:"repository"})," for the sample backend code. This includes instructions on how to run the server locally."]}),"\n",(0,a.jsx)(t.p,{children:"You will need to expose it to the public internet so that Automation Builder can call the API. While this is assumed knowledge and beyond the scope of the tutorial, we used a service from <ngrok.com> to expose the server running locally for demonstration purposes."}),"\n",(0,a.jsx)(t.h3,{id:"code-explanation---api",children:"Code Explanation - API"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"from flask import Flask, request\nfrom google_calendar_create_event import create_event\nfrom google_calendar_retrieve_events import retrieve_events\napp = Flask(__name__)\n\n@app.route(\"/create_meeting\", methods=['POST'])\ndef create_meeting():\n     # Retrieve JSON data from the request body\n    request_data = request.get_json()\n\n    # Extract the \"start\" and \"end\" parameters from the JSON data\n    start = request_data.get('start')\n    end = request_data.get('end')\n    customer_email = request_data.get('customer_email')\n    return create_event(start, end, customer_email)\n\n@app.route(\"/retrieve_meetings\")\ndef retrieve_meetings():\n    return retrieve_events()\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5003)\n\n"})}),"\n",(0,a.jsx)(t.p,{children:"This is the API code, it exposes two endpoints:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["The ",(0,a.jsx)(t.strong,{children:"/create_meeting"})," endpoint which will gather information about which meeting timeslot to book."]}),"\n",(0,a.jsxs)(t.li,{children:["The ",(0,a.jsx)(t.strong,{children:"/retrieve_meetings"})," endpoint which will return available timeslots from a user's google calendar."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"In this example, we hardcode the Google Calendar that we want to book meetings to in our config file. Also note, that this tutorial assumes that you have access rights to the Google Calendar API for that user."}),"\n",(0,a.jsx)(t.h3,{id:"code-explanation---retrieve-events",children:"Code Explanation - Retrieve Events"}),"\n",(0,a.jsxs)(t.p,{children:["This code is responsible for retrieving events from your chosen Google Calendar user's calendar in order to find out which timeslots are free. These are returned in lines 135-144 as a human readable text to be printed by Automation Builder in ",(0,a.jsx)(t.strong,{children:"Step 8)"})," in the tutorial."]}),"\n",(0,a.jsxs)(t.p,{children:["Please note it requires the use of credentials for the Google Calendar API in line 80. Google has a ",(0,a.jsx)(t.a,{href:"https://developers.google.com/calendar/api/quickstart/python",children:"quickstart"})," on getting started with the Google Calendar API which we used as the basis for this backend code. Please read through their quick start in order to generate the credentials.json which will be used as the google_api_creds.json below."]}),"\n",(0,a.jsx)(t.p,{children:"Also please note, the code uses the Singapore timezone by default in line 93 which should be changed according to your google calendar user's timezone."}),"\n",(0,a.jsx)(t.p,{children:"Retrieve Events"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"from __future__ import print_function\n\nimport datetime\nimport os.path\nimport json\n\nfrom google.auth.transport.requests import Request\nfrom google.oauth2.credentials import Credentials\nfrom google_auth_oauthlib.flow import InstalledAppFlow\nfrom googleapiclient.discovery import build\nfrom googleapiclient.errors import HttpError\n\n# If modifying these scopes, delete the file token.json.\nSCOPES = ['https://www.googleapis.com/auth/calendar']\n\n# Function to format a datetime object as a human-readable string\ndef format_datetime(dt):\n    return dt.strftime('%A, %d %B %Y %H:%M')\n\n# Function to check if a date is a weekday (Monday to Friday)\ndef is_weekday(date):\n    return date.weekday() < 5  # Monday to Friday are 0 to 4\n\n# Function to format time slots\ndef format_time_slot(slot, option_number):\n    start_time = datetime.fromisoformat(slot[\"start\"])\n    end_time = datetime.fromisoformat(slot[\"end\"])\n    formatted_option = f\"Option {option_number}) {start_time.strftime('%B %d, %I%p')} - {end_time.strftime('%I%p')}\"\n    return formatted_option\n\ndef get_next_weekday(now_singapore):\n    # Check if it's a weekday and within the 9 AM to 6 PM time range\n    if is_weekday(now_singapore) and now_singapore.hour < 9:\n        # If today is a weekday and within the specified time range, use the current time\n        start_singapore = now_singapore.replace(hour=9, minute=0, second=0, microsecond=0)\n    elif is_weekday(now_singapore) and now_singapore.hour >=18:\n        # Determine the number of days to add to get to the next weekday\n        if now_singapore.weekday() in [0, 1, 2, 3]:\n            next_weekday = now_singapore + datetime.timedelta(days=1)\n        else:\n            next_weekday = now_singapore + datetime.timedelta(days=3)\n\n        # Set the start and end times for the next weekday\n        start_singapore = next_weekday.replace(hour=9, minute=0, second=0, microsecond=0)\n    elif is_weekday(now_singapore) and 9 <= now_singapore.hour < 18:\n        #Pick the next timeslot at least an hour away\n        next_weekday = now_singapore + datetime.timedelta(hours=1) #This needs to be one hour or the logic for retrieve events will break \n        start_singapore = next_weekday.replace(minute=0, second=0, microsecond=0)\n    else:\n        if now_singapore.weekday() == 5:\n            next_weekday = now_singapore + datetime.timedelta(days=2)\n        else:\n            next_weekday = now_singapore + datetime.timedelta(days=1)\n        start_singapore = next_weekday.replace(hour=9, minute=0, second=0, microsecond=0)\n    return start_singapore\n\ndef is_valid_timeslot(timeslot):\n    if is_weekday(timeslot) and 9 <= timeslot.hour < 18:\n        return True\n    else:\n        return False\n\ndef retrieve_events():\n    \"\"\"Shows basic usage of the Google Calendar API.\n    Prints the start and name of the next 10 events on the user's calendar.\n    \"\"\"\n    creds = None\n    # The file token.json stores the user's access and refresh tokens, and is\n    # created automatically when the authorization flow completes for the first\n    # time.\n    if os.path.exists('token.json'):\n        creds = Credentials.from_authorized_user_file('token.json', SCOPES)\n    # If there are no (valid) credentials available, let the user log in.\n    if not creds or not creds.valid:\n        if creds and creds.expired and creds.refresh_token:\n            creds.refresh(Request())\n        else:\n            flow = InstalledAppFlow.from_client_secrets_file(\n                'google_api_creds.json', SCOPES)\n            creds = flow.run_local_server(port=0)\n        # Save the credentials for the next run\n        with open('token.json', 'w') as token:\n            token.write(creds.to_json())\n\n    try:\n        # Build Google calendar Service\n        service = build('calendar', 'v3', credentials=creds)\n        \n        # Get current time in Singapore timezone\n        singapore_timezone = datetime.timezone(datetime.timedelta(hours=8))  # UTC+8\n        now_singapore = datetime.datetime.now(singapore_timezone)\n\n        # Get Start of next Weekday\n        start_singapore = get_next_weekday(now_singapore)\n\n        # Create a list to store available time slots\n        available_time_slots = []\n\n        # Create a list to store human-readable date options\n        date_options = []\n\n        # Iterate through the time slots until there are at least 3.\n        current_time = start_singapore\n        option_number = 1\n        iterator = 1\n        print(\"current time = \" + str(current_time))\n        while len(available_time_slots) < 3:\n            print(iterator)\n            iterator+=1\n            # Check if the current time slot is available\n            events_result = service.events().list(calendarId='primary', timeMin=current_time.isoformat(),\n                                                timeMax=(current_time + datetime.timedelta(hours=1)).isoformat(),\n                                                maxResults=1, singleEvents=True, orderBy='startTime').execute()\n            events = events_result.get('items', [])\n\n            # If no event is scheduled, the slot is available\n            if not events and is_valid_timeslot(current_time):\n                slot_start = current_time\n                slot_end = current_time + datetime.timedelta(hours=1)\n                \n                # Add the human-readable date option\n                date_options.append(f\"Option {option_number}: {format_datetime(slot_start)} - {format_datetime(slot_end)}\")\n                \n                available_time_slots.append({'start': slot_start.isoformat(), 'end': slot_end.isoformat()})\n                option_number+=1\n\n            current_time = get_next_weekday(current_time)\n\n        # Convert the list of date options to a human-readable string\n        date_options_str = \"\\n\".join(date_options)\n\n        # Return the available_time_slots JSON and the human-readable date options as a tuple\n        result = {\n            \"date_options\": date_options_str,\n            \"timeslot1_start\": available_time_slots[0]['start'],\n            \"timeslot1_end\": available_time_slots[0]['end'],\n            \"timeslot2_start\": available_time_slots[1]['start'],\n            \"timeslot2_end\": available_time_slots[1]['end'],\n            \"timeslot3_start\": available_time_slots[2]['start'],\n            \"timeslot3_end\": available_time_slots[2]['end']\n        }\n        return result\n            \n\n    except HttpError as error:\n        print('An error occurred: %s' % error)\n\nif __name__ == '__main__':\n    retrieve_events()\n\n"})}),"\n",(0,a.jsx)(t.h3,{id:"code-explanation---create-event",children:"Code Explanation - Create Event"}),"\n",(0,a.jsxs)(t.p,{children:["This code is responsible for creating events once the customer has decided which event to book. The API endpoint is called in ",(0,a.jsx)(t.strong,{children:"Step 7)"})," of the automation builder workflow."]}),"\n",(0,a.jsx)(t.p,{children:"Please note it requires the use of credentials for the Google Calendar API as mentioned in the section above."}),"\n",(0,a.jsx)(t.p,{children:"Create Event"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"# Refer to the Python quickstart on how to setup the environment:\n# https://developers.google.com/calendar/quickstart/python\n# Change the scope to 'https://www.googleapis.com/auth/calendar' and delete any\n# stored credentials.\nfrom __future__ import print_function\nfrom flask import jsonify\nimport datetime\nimport os.path\nimport config\n\nfrom google.auth.transport.requests import Request\nfrom google.oauth2.credentials import Credentials\nfrom google_auth_oauthlib.flow import InstalledAppFlow\nfrom googleapiclient.discovery import build\nfrom googleapiclient.errors import HttpError\n\n# If modifying these scopes, delete the file token.json.\nSCOPES = ['https://www.googleapis.com/auth/calendar']\n\ndef generate_request_id(customer_email):\n    # Generate a unique requestId based on current date, time, and guest email\n        current_time = datetime.datetime.now().strftime(\"%Y%m%d%H%M%S\")\n        request_id = f'{current_time}_{customer_email}'\n        return request_id\n\ndef create_event(timeslot_start, timeslot_end, customer_email):\n    \"\"\"Shows basic usage of the Google Calendar API.\n    Prints the start and name of the next 10 events on the user's calendar.\n    \"\"\"\n    creds = None\n    # The file token.json stores the user's access and refresh tokens, and is\n    # created automatically when the authorization flow completes for the first\n    # time.\n    if os.path.exists('token.json'):\n        creds = Credentials.from_authorized_user_file('token.json', SCOPES)\n    # If there are no (valid) credentials available, let the user log in.\n    if not creds or not creds.valid:\n        if creds and creds.expired and creds.refresh_token:\n            creds.refresh(Request())\n        else:\n            flow = InstalledAppFlow.from_client_secrets_file(\n                'google_api_creds.json', SCOPES)\n            creds = flow.run_local_server(port=0)\n        # Save the credentials for the next run\n        with open('token.json', 'w') as token:\n            token.write(creds.to_json())\n\n    try:\n        service = build('calendar', 'v3', credentials=creds)\n        request_id = generate_request_id(customer_email)\n        event = {\n            'summary': '8x8 Customer Meeting',\n            'description': 'A chance to speak to a 8x8 support team expert.',\n            'start': {\n                'dateTime': timeslot_start,\n                'timeZone': 'Asia/Singapore',\n            },\n            'end': {\n                'dateTime': timeslot_end,\n                'timeZone': 'Asia/Singapore',\n            },\n            'reminders': {\n                'useDefault': False,\n                'overrides': [\n                {'method': 'email', 'minutes': 24 * 60},\n                {'method': 'popup', 'minutes': 10},\n                ],\n            },\n            'attendees': [\n                {'email': config.GOOGLE_ACCOUNT},\n                {'email': customer_email},\n            ],\n            'conferenceData': {\n                'conferenceSolution': {\n                    'key': {\n                        \"type\":\"addOn\"\n                    },\n                    'name': '8x8'\n                },\n                'entryPoints': [\n                    {\n                        'entryPointType': 'video',\n                        'uri': 'https://8x8.vc/8x8/'+request_id,  # Replace with your custom conference link\n                        'label': 'https://8x8.vc/8x8/'+request_id,\n                    }\n                ]\n            }\n        }\n\n        event_details = service.events().insert(calendarId='primary', body=event, conferenceDataVersion=1,sendUpdates=\"all\").execute()\n\n        return jsonify(event_details)\n    \n    except HttpError as error:\n        print(str(error))\n        return jsonify({'error': str(error)}), 400\n\nif __name__ == '__main__':\n    create_event()\n\n"})}),"\n",(0,a.jsx)(t.h3,{id:"google-calendar-organizational-use",children:"Google Calendar Organizational Use"}),"\n",(0,a.jsxs)(t.p,{children:["Use for an organization is beyond the scope of this tutorial. If you are trying to book to a Google Calendar for a user managed by an organization, then you may need to ask your IT team's admin for access to a service account with account-wide delegation ",(0,a.jsx)(t.a,{href:"https://support.google.com/a/answer/162106?hl=en",children:"access"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},83212:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/b56b6c5-image-24e9ca4aa1f81abad0c8c5dee522d3fe.png"},85057:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/5cf7320-image-957e2e72e0010f919a3310209ef77f23.png"},87176:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/c7348d6-image-c2dc162e0436afc83e334ca07055c617.png"},91229:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/4883414-image-87a9a2d1280487a8d0bb5f048f5c9b90.png"},93485:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/4b3e879-image-83542fddd38324294083f3ec5dcb3798.png"},97007:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/d045c6b-image-85b38951a73d5d292bcc90e9dbbf0e11.png"},97831:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/bb9426a-image-32eb2d797817ff635a0c654b780d538d.png"}}]);