"use strict";(self.webpackChunk_8x8_developer_docs=self.webpackChunk_8x8_developer_docs||[]).push([[76869],{28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var i=s(96540);const a={},t=i.createContext(a);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},30593:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"connect/docs/chatapps-fallback-management","title":"Messaging Apps Fallback management","description":"The 8x8 Messaging API enables you to define a fallback sequence, orchestrating message delivery across multiple channels such as WhatsApp, Viber, and SMS.","source":"@site/docs/connect/docs/chatapps-fallback-management.md","sourceDirName":"connect/docs","slug":"/connect/docs/chatapps-fallback-management","permalink":"/connect/docs/chatapps-fallback-management","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebarConnectReference","previous":{"title":"WhatsApp Phone Number Quality Change Webhook","permalink":"/connect/docs/whatsapp-phone-number-quality-change-webhook"},"next":{"title":"Messaging Apps Delivery Receipt Error Codes","permalink":"/connect/docs/delivery-error-codes"}}');var a=s(74848),t=s(28453);const l={},c="Messaging Apps Fallback management",r={},d=[{value:"Configuring a Fallback Sequence",id:"configuring-a-fallback-sequence",level:2},{value:"Message Status Reference",id:"message-status-reference",level:2},{value:"Conditional Fallback Based on Message Delivery",id:"conditional-fallback-based-on-message-delivery",level:2},{value:"Single-Channel Messaging",id:"single-channel-messaging",level:2},{value:"Aligning Fallback Timing with WhatsApp Template TTL",id:"aligning-fallback-timing-with-whatsapp-template-ttl",level:2},{value:"<strong>Example: Coordinating WhatsApp Template Validity with SMS Fallback Timing</strong>",id:"example-coordinating-whatsapp-template-validity-with-sms-fallback-timing",level:3}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"messaging-apps-fallback-management",children:"Messaging Apps Fallback management"})}),"\n",(0,a.jsx)(n.p,{children:"The 8x8 Messaging API enables you to define a fallback sequence, orchestrating message delivery across multiple channels such as WhatsApp, Viber, and SMS."}),"\n",(0,a.jsxs)(n.p,{children:["Fallback configurations can be set at the subaccount level (contact your account manager for assistance) or specified per message via the ",(0,a.jsx)(n.a,{href:"/connect/reference/chatapps-send-api",children:"Messaging Apps Send API"}),"."]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\ud83d\udea7 ",(0,a.jsx)(n.strong,{children:"Note"})]}),"\n",(0,a.jsx)(n.p,{children:"Fallback sequences defined in the Send API override any existing subaccount-level settings."}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"configuring-a-fallback-sequence",children:"Configuring a Fallback Sequence"}),"\n",(0,a.jsxs)(n.p,{children:["To define a fallback sequence, include the ",(0,a.jsx)(n.code,{children:"channels"})," array in your message payload. Each channel object can specify:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"channel"})}),": The messaging channel (e.g., ",(0,a.jsx)(n.code,{children:"WhatsApp"}),", ",(0,a.jsx)(n.code,{children:"Viber"}),", ",(0,a.jsx)(n.code,{children:"SMS"}),")."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"fallbackAfter"})})," ",(0,a.jsx)(n.em,{children:"(optional)"}),": Time in seconds to wait before triggering the next channel."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"successStatus"})})," ",(0,a.jsx)(n.em,{children:"(optional)"}),": The message status considered as successful delivery (",(0,a.jsx)(n.code,{children:"Accepted"}),", ",(0,a.jsx)(n.code,{children:"Sent"}),", ",(0,a.jsx)(n.code,{children:"Delivered"}),", ",(0,a.jsx)(n.code,{children:"Read"}),")."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "channels": [\n    { "channel": "WhatsApp", "fallbackAfter": 60, "successStatus": "Read" },\n    { "channel": "Viber", "fallbackAfter": 60, "successStatus": "Delivered" },\n    { "channel": "SMS" }\n  ],\n  "user": {\n    "msisdn": "+65000000"\n  },\n  "type": "text",\n  "content": {\n    "text": "Hello World!",\n    "sms": {\n      "encoding": "AUTO",\n      "source": "SENDERID"\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"In this configuration:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["The message is first sent via ",(0,a.jsx)(n.strong,{children:"WhatsApp"}),". If not ",(0,a.jsx)(n.strong,{children:"read"})," within 60 seconds, it falls back to:"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Viber"}),". If not ",(0,a.jsx)(n.strong,{children:"delivered"})," within 60 seconds, it finally falls back to:"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"SMS"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"message-status-reference",children:"Message Status Reference"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"successStatus"})," parameter determines which message status is considered a successful delivery, preventing fallback to the next channel. Possible values include:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Accepted"}),": Message accepted by 8x8's platform."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Sent"}),": Message sent to the operator; acknowledgment pending."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Delivered"}),": Message delivered to the recipient."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Read"}),": Message read by the recipient."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["For detailed status definitions, refer to the ",(0,a.jsx)(n.a,{href:"/connect/reference/message-status-references",children:"Message Status Reference"}),"."]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"conditional-fallback-based-on-message-delivery",children:"Conditional Fallback Based on Message Delivery"}),"\n",(0,a.jsx)(n.p,{children:"To attempt delivery via WhatsApp and fallback to SMS only if the message is not delivered within a specific timeframe, configure as follows:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "channels": [\n    {\n      "channel": "WhatsApp",\n      "fallbackAfter": 60,\n      "successStatus": "Delivered"\n    },\n    {\n      "channel": "SMS"\n    }\n  ],\n  "user": {\n    "msisdn": "+65000000"\n  },\n  "type": "text",\n  "content": {\n    "text": "Hello World!",\n    "sms": {\n      "encoding": "AUTO",\n      "source": "SENDERID"\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"In this setup:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["The message is sent via ",(0,a.jsx)(n.strong,{children:"WhatsApp"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["If the message is not ",(0,a.jsx)(n.strong,{children:"delivered"})," within 60 seconds, it falls back to ",(0,a.jsx)(n.strong,{children:"SMS"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This configuration ensures that the fallback to SMS occurs only if the WhatsApp message isn't delivered within the specified timeframe."}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"single-channel-messaging",children:"Single-Channel Messaging"}),"\n",(0,a.jsxs)(n.p,{children:["If you intend to send a message exclusively through a single channel without any fallback options, you can specify only that channel in the ",(0,a.jsx)(n.code,{children:"channels"})," array."]}),"\n",(0,a.jsxs)(n.p,{children:["In such cases, the ",(0,a.jsx)(n.code,{children:"fallbackAfter"})," and ",(0,a.jsx)(n.code,{children:"successStatus"})," parameters are ",(0,a.jsx)(n.strong,{children:"optional"})," and typically ",(0,a.jsx)(n.strong,{children:"unnecessary"}),", as there are no subsequent channels to fallback to."]}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "channels": [\n    { "channel": "WhatsApp" }\n  ],\n  "user": {\n    "msisdn": "+65000000"\n  },\n  "type": "text",\n  "content": {\n    "text": "Hello World!",\n    "sms": {\n      "encoding": "AUTO",\n      "source": "SENDERID"\n    }\n  }\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["In this configuration, the message is sent solely via ",(0,a.jsx)(n.strong,{children:"WhatsApp"}),", with no fallback to other channels."]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"aligning-fallback-timing-with-whatsapp-template-ttl",children:"Aligning Fallback Timing with WhatsApp Template TTL"}),"\n",(0,a.jsxs)(n.p,{children:["When using WhatsApp Utility or Authentication templates, it's crucial to configure the template's Time-To-Live (TTL) appropriately. Setting a TTL ensures that WhatsApp will attempt to deliver the message within a specified timeframe. To prevent delivering duplicate messages, ensure that your fallback duration (",(0,a.jsx)(n.code,{children:"fallbackAfter"}),") exceeds the template's TTL. This strategy allows WhatsApp to attempt delivery within its validity period before triggering fallback channels like SMS."]}),"\n",(0,a.jsxs)(n.p,{children:["For detailed guidance on configuring TTL, refer to the ",(0,a.jsx)(n.a,{href:"/connect/docs/guide-whatsapp-template-validity-period-ttl",children:"WhatsApp Template Validity Period (TTL) Guide"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"example-coordinating-whatsapp-template-validity-with-sms-fallback-timing",children:(0,a.jsx)(n.strong,{children:"Example: Coordinating WhatsApp Template Validity with SMS Fallback Timing"})}),"\n",(0,a.jsxs)(n.p,{children:["Consider a scenario where you send a delivery notification via a WhatsApp Utility template with a validity of 10 minutes (600 seconds). To prevent duplicate messages, set the ",(0,a.jsx)(n.code,{children:"fallbackAfter"})," duration to exceed the WhatsApp template validity. For instance, setting ",(0,a.jsx)(n.code,{children:"fallbackAfter"})," to 900 seconds ensures that the fallback to SMS occurs only after WhatsApp's delivery window has expired."]}),"\n",(0,a.jsx)(n.p,{children:"Here's a simplified flow diagram illustrating this process:"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image",src:s(68467).A+"",width:"1609",height:"321"})}),"\n",(0,a.jsx)(n.p,{children:"In this flow:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Start"}),": Initiate the process."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Send WhatsApp Utility Template"}),": Dispatch the message via WhatsApp with a TTL of 10 minutes."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Delivered within TTL?"}),": Check if the message was delivered within the TTL."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Yes"}),": If delivered, end the process."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"No"}),": If not delivered, proceed to wait until TTL expires."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Wait until TTL expires"}),": Hold until the TTL period concludes."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Trigger SMS Fallback"}),": Send the message via SMS as a fallback."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"End"}),": Conclude the process."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This setup ensures that the fallback to SMS occurs only after the WhatsApp message's validity period has expired"}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\u2757\ufe0f ",(0,a.jsx)(n.strong,{children:"Important"})]}),"\n",(0,a.jsx)(n.p,{children:"Ensure that your fallback settings align with the channels you intend to use and that all necessary configurations (e.g., sender IDs, templates) are properly set up for each channel."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["For a comprehensive list of supported messaging channels, refer to ",(0,a.jsx)(n.a,{href:"/connect/reference/list-of-supported-chatapps-channels",children:"Supported Messaging Apps"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},68467:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/94d6af03e9b289df4b5ff226567a0f0531ab415307923da0181e7b67895fa836-image-ef4f31b12f2ece8ffe0ca0c4df35e517.png"}}]);