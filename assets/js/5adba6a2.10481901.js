"use strict";(globalThis.webpackChunk_8x8_developer_docs=globalThis.webpackChunk_8x8_developer_docs||[]).push([[58167],{6083:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/7a5bf0e-image-c652ce04784e43e6284220fb744ca39d.png"},9306:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/93ecf2c74082d634d0b4d85226e447653fb7fdc57e6eefaa8c7206d5970f4c31-image-b77736b8b3c6dd6e9114dbf09bd1bb03.png"},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var o=i(96540);const t={},r=o.createContext(t);function s(e){const n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(r.Provider,{value:n},e.children)}},34925:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/37a551d-image-700390f1f344ff724492725f65a73ce0.png"},36184:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/2959b4b-image-308412898c681e03b5a372eb5542d319.png"},68119:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/c22d8d7-image-5ff1a4ef853ed86dba87429d67cb0156.png"},71851:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/fa1267cdfaf02f591262999bb5179c2038a5097ceefed712857dbd0ecd9099d2-image-92a15671056c88a8b729b5c1c6e66dc6.png"},75276:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"connect/docs/okta-bring-your-own-telephony-byot-via-voice-otp","title":"Okta - Bring Your Own Telephony (BYOT) via Voice","description":"Overview","source":"@site/docs/connect/docs/okta-bring-your-own-telephony-byot-via-voice-otp.md","sourceDirName":"connect/docs","slug":"/connect/docs/okta-bring-your-own-telephony-byot-via-voice-otp","permalink":"/connect/docs/okta-bring-your-own-telephony-byot-via-voice-otp","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebarConnectDocs","previous":{"title":"Okta - Bring Your Own Telephony (BYOT) via SMS","permalink":"/connect/docs/okta"},"next":{"title":"Salesforce Chat Configuration Guide","permalink":"/connect/docs/salesforce-live-agent"}}');var t=i(74848),r=i(28453);const s={},a="Okta - Bring Your Own Telephony (BYOT) via Voice",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Integration Flow",id:"integration-flow",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Step 1: Backend Code Setup",id:"step-1-backend-code-setup",level:3},{value:"Step 2: Environment Configuration",id:"step-2-environment-configuration",level:3},{value:"Step 3: Main Server Implementation",id:"step-3-main-server-implementation",level:3},{value:"Step 4: Package Configuration",id:"step-4-package-configuration",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Step 5: Okta Inline Hook Setup",id:"step-5-okta-inline-hook-setup",level:3},{value:"Step 6: Authentication Policy Configuration",id:"step-6-authentication-policy-configuration",level:3},{value:"Testing the Integration",id:"testing-the-integration",level:2},{value:"Step 7: Test the Implementation",id:"step-7-test-the-implementation",level:3},{value:"Request/Response Examples",id:"requestresponse-examples",level:2},{value:"Okta Webhook Request Example",id:"okta-webhook-request-example",level:3},{value:"Your Service Response Example",id:"your-service-response-example",level:3},{value:"Using the Inline Hook",id:"using-the-inline-hook",level:2},{value:"Add Authenticator",id:"add-authenticator",level:3},{value:"Create new Authentication Policy Rule",id:"create-new-authentication-policy-rule",level:3},{value:"Add to Application",id:"add-to-application",level:3},{value:"Signing In",id:"signing-in",level:3},{value:"Security Considerations",id:"security-considerations",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Common Issues",id:"common-issues",level:4},{value:"Monitoring and Logs",id:"monitoring-and-logs",level:4},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"okta---bring-your-own-telephony-byot-via-voice",children:"Okta - Bring Your Own Telephony (BYOT) via Voice"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"This guide demonstrates how to implement voice-based One-Time Password (OTP) delivery for Okta authentication using 8x8's Voice API. This integration allows you to create a custom telephony provider that delivers OTPs via voice calls instead of SMS."}),"\n",(0,t.jsxs)(n.p,{children:["The integration works by creating a webhook service that receives OTP delivery requests from ",(0,t.jsx)(n.a,{href:"https://developer.okta.com/docs/api/openapi/okta-management/management/tag/InlineHook/#tag/InlineHook/operation/createTelephonyInlineHook",children:"Okta's Inline Hook"})," and uses 8x8's Voice API to deliver the OTP via a voice call to the user's phone number."]}),"\n",(0,t.jsx)(n.h3,{id:"integration-flow",children:"Integration Flow"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Detailed Flow:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"User initiates login"})," with multi-factor authentication enabled"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Okta triggers"})," the Inline Hook with user details and OTP"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Your webhook service"})," receives the request and extracts phone number and OTP"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Service calls 8x8 Voice API"})," to initiate a voice call with the OTP message"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"User receives voice call"})," with spoken OTP and completes authentication"]}),"\n"]}),"\n",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(n.p,{children:"Before you begin, ensure you have:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Okta Account"})," with admin access to configure Inline Hooks"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"8x8 Account"})," with access to Voice API credentials"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"JavaScript/Node.js knowledge"})," for backend development"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Public HTTPS endpoint"})," for receiving Okta webhooks (consider using ngrok for development)"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Node.js"}),"\n",(0,t.jsx)(n.li,{children:"npm package manager"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"implementation",children:"Implementation"}),"\n",(0,t.jsx)(n.h3,{id:"step-1-backend-code-setup",children:"Step 1: Backend Code Setup"}),"\n",(0,t.jsx)(n.p,{children:"Create a new Node.js project and install dependencies:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mkdir okta-voice-otp\ncd okta-voice-otp\nnpm init -y\nnpm install express dotenv\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-2-environment-configuration",children:"Step 2: Environment Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Create a ",(0,t.jsx)(n.code,{children:".env"})," file with your configuration:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-env",children:"# Server Configuration\nPORT=3000\nOKTA_SECRET=your_okta_webhook_secret_here\n\n# 8x8 Voice API Configuration\nEIGHTYEIGHTX_SUBACCOUNT_ID=your_subaccount_id\nEIGHTYEIGHTX_API_KEY=your_api_key\nEIGHTYEIGHTX_SOURCE_NUMBER=+1234567890\n\n# Voice Configuration\nVOICE_PROFILE=en-US-Jenny\nOTP_REPETITIONS=2\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-3-main-server-implementation",children:"Step 3: Main Server Implementation"}),"\n",(0,t.jsxs)(n.p,{children:["Create ",(0,t.jsx)(n.code,{children:"server.js"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const express = require('express');\nconst https = require('https');\nconst dotenv = require('dotenv');\n\ndotenv.config();\n\nconst app = express();\nconst PORT = process.env.PORT || 3000;\n\n// Middleware\napp.use(express.json());\n\n// Health check endpoint\napp.get('/health', (req, res) => {\n  res.status(200).json({ status: 'OK', timestamp: new Date().toISOString() });\n});\n\n/**\n * Sends an OTP to a user via an 8x8 voice call.\n * @param {string} phoneNumber - The recipient's phone number in E.164 format\n * @param {string} otpCode - The one-time password to be delivered\n * @returns {Promise<Object>} Response from 8x8 API\n */\nasync function sendVoiceOTP(phoneNumber, otpCode) {\n  const subaccountId = process.env.EIGHTYEIGHTX_SUBACCOUNT_ID;\n  const apiKey = process.env.EIGHTYEIGHTX_API_KEY;\n  const sourceNumber = process.env.EIGHTYEIGHTX_SOURCE_NUMBER;\n  const voiceProfile = process.env.VOICE_PROFILE || 'en-US-Jenny';\n  const repetitions = parseInt(process.env.OTP_REPETITIONS) || 2;\n\n  const payload = JSON.stringify({\n    callflow: [\n      {\n        action: 'makeCall',\n        params: {\n          source: sourceNumber,\n          destination: phoneNumber\n        }\n      },\n      {\n        action: 'say',\n        params: {\n          text: `Your verification code is ${otpCode.split('').join(', ')}. I repeat, your verification code is ${otpCode.split('').join(', ')}.`,\n          voiceProfile: voiceProfile,\n          repetition: repetitions\n        }\n      },\n      {\n        action: 'hangup'\n      }\n    ]\n  });\n\n  const options = {\n    hostname: 'voice.wavecell.com',\n    port: 443,\n    path: `/api/v1/subaccounts/${subaccountId}/callflows`,\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${apiKey}`,\n      'Content-Length': Buffer.byteLength(payload)\n    }\n  };\n\n  return new Promise((resolve, reject) => {\n    const req = https.request(options, (res) => {\n      let data = '';\n      res.on('data', (chunk) => {\n        data += chunk;\n      });\n      res.on('end', () => {\n        try {\n          const response = JSON.parse(data);\n          if (res.statusCode >= 200 && res.statusCode < 300) {\n            console.log('[8x8 Service] Voice call initiated successfully:', response);\n            resolve(response);\n          } else {\n            console.error('[8x8 Service] API error:', response);\n            reject(new Error(`8x8 API error: ${response.message || 'Unknown error'}`));\n          }\n        } catch (error) {\n          console.error('[8x8 Service] Failed to parse response:', error);\n          reject(error);\n        }\n      });\n    });\n\n    req.on('error', (error) => {\n      console.error('[8x8 Service] Request error:', error);\n      reject(error);\n    });\n\n    req.write(payload);\n    req.end();\n  });\n}\n\n/**\n * Validates the incoming Okta webhook request\n * @param {Object} req - Express request object\n * @returns {boolean} True if request is valid\n */\nfunction validateOktaRequest(req) {\n  // For production, implement proper Okta webhook signature validation if needed\n  const oktaSecret = process.env.OKTA_SECRET;\n  const authHeader = req.headers.authorization;\n\n  // If auth header is provided, validate it\n  if (authHeader && oktaSecret) {\n    return authHeader === `Bearer ${oktaSecret}`;\n  }\n\n  // Allow requests without auth headers for simplicity\n  // In production, consider implementing webhook signature validation\n  return true;\n}\n\n// Okta Voice OTP webhook endpoint\napp.post('/okta-voice-otp', async (req, res) => {\n  try {\n    console.log('[Server] Received Okta webhook request');\n\n    // Validate request\n    if (!validateOktaRequest(req)) {\n      console.warn('[Server] Unauthorized request received');\n      return res.status(401).json({ error: 'Unauthorized' });\n    }\n\n    // Extract data from Okta payload\n    const { data } = req.body;\n    if (!data || !data.userProfile || !data.messageProfile) {\n      console.error('[Server] Invalid Okta payload structure');\n      return res.status(400).json({ error: 'Invalid payload structure' });\n    }\n\n    const phoneNumber = data.messageProfile.phoneNumber || data.userProfile.mobilePhone;\n    const otpCode = data.messageProfile.otpCode;\n\n    if (!phoneNumber || !otpCode) {\n      console.error('[Server] Missing phone number or OTP code');\n      return res.status(400).json({ error: 'Missing required fields' });\n    }\n\n    console.log(`[Server] Processing OTP delivery for ${phoneNumber.replace(/\\d(?=\\d{4})/g, '*')}`);\n\n    // Respond to Okta immediately\n    res.status(200).json({\n      commands: [{\n        type: 'com.okta.telephony.action',\n        value: [{\n          status: 'SUCCESSFUL',\n          provider: '8x8-voice'\n        }]\n      }]\n    });\n\n    // Handle voice call asynchronously\n    try {\n      await sendVoiceOTP(phoneNumber, otpCode);\n      console.log('[Server] Voice OTP delivery initiated successfully');\n    } catch (error) {\n      console.error('[Server] Failed to send voice OTP:', error.message);\n      // Note: We already responded to Okta, so this is logged for monitoring\n    }\n\n  } catch (error) {\n    console.error('[Server] Webhook processing error:', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});\n\n// Global error handler\napp.use((error, req, res, next) => {\n  console.error('[Server] Unhandled error:', error);\n  res.status(500).json({ error: 'Internal server error' });\n});\n\n// Start server\napp.listen(PORT, () => {\n  console.log(`[Server] Voice OTP service running on port ${PORT}`);\n  console.log(`[Server] Webhook endpoint: http://localhost:${PORT}/okta-voice-otp`);\n});\n\nmodule.exports = app;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-4-package-configuration",children:"Step 4: Package Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Update your ",(0,t.jsx)(n.code,{children:"package.json"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "okta-voice-otp",\n  "version": "1.0.0",\n  "description": "Okta BYOT with 8x8 Voice API for OTP delivery",\n  "main": "server.js",\n  "scripts": {\n    "start": "node server.js",\n    "dev": "node server.js"\n  },\n  "keywords": ["okta", "8x8", "voice", "otp", "byot"],\n  "author": "Your Name",\n  "license": "MIT",\n  "dependencies": {\n    "express": "^4.18.0",\n    "dotenv": "^16.0.0"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"step-5-okta-inline-hook-setup",children:"Step 5: Okta Inline Hook Setup"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Access Okta Admin Console"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Log into your Okta organization as an administrator"}),"\n",(0,t.jsxs)(n.li,{children:["Navigate to ",(0,t.jsx)(n.strong,{children:"Workflow > Inline Hooks"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Create New Inline Hook"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Click ",(0,t.jsx)(n.strong,{children:"Add Inline Hook"})]}),"\n",(0,t.jsxs)(n.li,{children:["Select ",(0,t.jsx)(n.strong,{children:"Telephony"})," as the hook type"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image",src:i(71851).A+"",width:"845",height:"523"})}),"\n",(0,t.jsx)(n.br,{}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.strong,{children:"Create Inline Hook"})," page, fill in the following values."]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Description"}),(0,t.jsx)(n.th,{children:"Example Value"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Name"})}),(0,t.jsx)(n.td,{children:'Can be any value. We use "8x8 - Voice Authentication"'}),(0,t.jsx)(n.td,{children:"8x8 - Voice Authentication"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"URL"})}),(0,t.jsx)(n.td,{children:"Should be set to the URL of your backend server that you send the code."}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://example.com/endpoint",children:"https://example.com/endpoint"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Authentication Field"})}),(0,t.jsxs)(n.td,{children:["Will be sent as part of the request header. Authentication Field is for your backend to authenticate the webhook from Okta. It can be any value",(0,t.jsx)(n.br,{}),(0,t.jsx)(n.br,{}),"Refer to Okta's ",(0,t.jsx)(n.a,{href:"https://developer.okta.com/docs/reference/hooks-best-practices/",children:"page"})," on authentication and Inline Hooks for reference."]}),(0,t.jsx)(n.td,{children:"Authentication"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Authentication Secret (Used with Authentication Field)"})}),(0,t.jsx)(n.td,{children:"Will be sent as part of the request header. This should be the value your backend uses to authenticate"}),(0,t.jsx)(n.td,{children:"secretvalue"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:["After entering the values, click ",(0,t.jsx)(n.strong,{children:"Save"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Configure Hook Settings"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Set the hook to trigger on authentication events"}),"\n",(0,t.jsx)(n.li,{children:"Enable the hook for your organization"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"step-6-authentication-policy-configuration",children:"Step 6: Authentication Policy Configuration"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Create Authentication Policy"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Navigate to ",(0,t.jsx)(n.strong,{children:"Security > Authentication > Authentication Policies"})]}),"\n",(0,t.jsx)(n.li,{children:"Create a new policy or edit existing one"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Configure MFA Rules"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Add a rule that requires phone verification"}),"\n",(0,t.jsx)(n.li,{children:"Set the telephony provider to use your custom hook"}),"\n",(0,t.jsx)(n.li,{children:"Configure when voice calls should be used (fallback, primary, etc.)"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Assign Policy"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Assign the policy to relevant applications and user groups"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"testing-the-integration",children:"Testing the Integration"}),"\n",(0,t.jsx)(n.h3,{id:"step-7-test-the-implementation",children:"Step 7: Test the Implementation"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Start Your Service"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm start\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Expose Your Local Service"})," (for development)"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Using ngrok\nngrok http 3000\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Update Okta Hook URL"})," with your ngrok URL"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Authentication Flow"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Attempt to sign in to an application with MFA enabled"}),"\n",(0,t.jsx)(n.li,{children:"Verify that voice call is initiated"}),"\n",(0,t.jsx)(n.li,{children:"Complete authentication with received OTP"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"requestresponse-examples",children:"Request/Response Examples"}),"\n",(0,t.jsx)(n.h3,{id:"okta-webhook-request-example",children:"Okta Webhook Request Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "eventId": "rZxqX4QGT1KIwr8KSh3C6A",\n    "eventTime": "2025-09-29T09:05:04.000Z",\n    "eventType": "com.okta.telephony.provider",\n    "eventTypeVersion": "1.0",\n    "contentType": "application/json",\n    "cloudEventVersion": "0.1",\n    "source": "https://integrator-xxxxxx.okta.com/api/v1/inlineHooks/calhawlks9zOkRrau0h7",\n    "requestType": "com.okta.user.telephony.mfa-verification",\n    "data": {\n        "context": {\n            "request": {\n                "id": "8d9c47117943da0585412539965xxxx",\n                "method": "POST",\n                "url": {\n                    "value": "/api/internal/v1/inlineHooks/com.okta.telephony.provider/generatePreview"\n                },\n                "ipAddress": "42.61.17.54"\n            }\n        },\n        "userProfile": {\n            "firstName": "Harris",\n            "lastName": "Doe",\n            "login": "harris@example.com",\n            "userId": "00uvw9bdliXTkH8qR697"\n        },\n        "messageProfile": {\n            "msgTemplate": "Your code is 11111",\n            "phoneNumber": "9876543210",\n            "otpExpires": "2025-09-29T09:09:59.759Z",\n            "deliveryChannel": "Voice",\n            "otpCode": "11111",\n            "locale": "en"\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"your-service-response-example",children:"Your Service Response Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:"JSON",children:'{\n    "error": null,\n    "commands": [\n        {\n            "type": "com.okta.telephony.action",\n            "value": [\n                {\n                    "status": "SUCCESSFUL",\n                    "provider": "8x8-voice",\n                    "transactionId": null,\n                    "transactionMetadata": null\n                }\n            ]\n        }\n    ],\n    "debugContext": {}\n}\n'})}),"\n",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.h2,{id:"using-the-inline-hook",children:"Using the Inline Hook"}),"\n",(0,t.jsx)(n.p,{children:"Now that the Inline Hook has been added, in order to require it for signing into your Okta organization."}),"\n",(0,t.jsx)(n.h3,{id:"add-authenticator",children:"Add Authenticator"}),"\n",(0,t.jsxs)(n.p,{children:["Ensure that in the ",(0,t.jsx)(n.strong,{children:"Security - Authenticators"})," page that Phone is added as an Authenticator option."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image",src:i(6083).A+"",width:"772",height:"452"})}),"\n",(0,t.jsxs)(n.p,{children:["If it is not already on the list then click ",(0,t.jsx)(n.strong,{children:"Add Authenticator"})," to add it."]}),"\n",(0,t.jsx)(n.h3,{id:"create-new-authentication-policy-rule",children:"Create new Authentication Policy Rule"}),"\n",(0,t.jsxs)(n.p,{children:["Click ",(0,t.jsx)(n.strong,{children:"Add Rule"})," on the ",(0,t.jsx)(n.strong,{children:"Security - Authentication Policies"})," page."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image",src:i(68119).A+"",width:"1058",height:"308"})}),"\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.strong,{children:"Edit Rule"})," page, the only change we will make is for AND Authentication methods where we should include the ",(0,t.jsx)(n.strong,{children:"Phone - Voice"})," method along with any other methods we wish to offer the user authenticating into Okta."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image",src:i(9306).A+"",width:"933",height:"316"})}),"\n",(0,t.jsx)(n.h3,{id:"add-to-application",children:"Add to Application"}),"\n",(0,t.jsx)(n.p,{children:"After creating the Policy, add it to one of your Applications."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image",src:i(34925).A+"",width:"759",height:"363"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image",src:i(36184).A+"",width:"1700",height:"1064"})}),"\n",(0,t.jsx)(n.h3,{id:"signing-in",children:"Signing In"}),"\n",(0,t.jsx)(n.p,{children:"When attempting to login to the application that you have configured above, you should receive the following screen prompting you to register for Phone Verification."}),"\n",(0,t.jsx)(n.p,{children:"The code should be sent to your phone via a phone call, follow the prompts to finish logging into application."}),"\n",(0,t.jsx)(n.h3,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Webhook Validation"}),": Implement proper signature validation for production use"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Environment Variables"}),": Never hardcode credentials in your source code"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"HTTPS"}),": Always use HTTPS for webhook endpoints in production"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Rate Limiting"}),": Implement rate limiting to prevent abuse"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Logging"}),": Log events for monitoring but avoid logging sensitive data"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h4,{id:"common-issues",children:"Common Issues"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Voice call not initiated"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Verify 8x8 API credentials and subaccount ID"}),"\n",(0,t.jsx)(n.li,{children:"Check phone number format (E.164)"}),"\n",(0,t.jsx)(n.li,{children:"Review API response for error messages"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Okta webhook not received"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Confirm webhook URL is accessible from internet"}),"\n",(0,t.jsx)(n.li,{children:"Verify SSL certificate is valid"}),"\n",(0,t.jsx)(n.li,{children:"Check Okta hook configuration and authentication"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Authentication failures"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Validate webhook secret configuration"}),"\n",(0,t.jsx)(n.li,{children:"Review request headers and authentication method"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"monitoring-and-logs",children:"Monitoring and Logs"}),"\n",(0,t.jsx)(n.p,{children:"Monitor your service logs for:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Incoming Okta webhook requests"}),"\n",(0,t.jsx)(n.li,{children:"8x8 API responses"}),"\n",(0,t.jsx)(n.li,{children:"Error conditions and failed calls"}),"\n",(0,t.jsx)(n.li,{children:"Performance metrics"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,t.jsx)(n.p,{children:"You've successfully implemented voice-based OTP delivery for Okta using 8x8's Voice API. This integration provides an alternative to SMS for users who prefer or require voice-based authentication methods."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);